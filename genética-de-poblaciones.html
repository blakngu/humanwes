<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 1 Genética de Poblaciones | Human Whole Exome Analysis</title>
  <meta name="description" content="Apuntes del curso Human Whole Exome Analysis" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 1 Genética de Poblaciones | Human Whole Exome Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apuntes del curso Human Whole Exome Analysis" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 1 Genética de Poblaciones | Human Whole Exome Analysis" />
  
  <meta name="twitter:description" content="Apuntes del curso Human Whole Exome Analysis" />
  

<meta name="author" content="Hugo Naya" />
<meta name="author" content="Lucía Spangenberg" />
<meta name="author" content="Camila Simoes" />


<meta name="date" content="2023-09-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="epidemio.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Genética II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Notas y “tutorial” para genética de poblaciones humana y algo de epidemiología genética</a></li>
<li class="part"><span><b>Genética de Poblaciones</b></span></li>
<li class="chapter" data-level="1" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html"><i class="fa fa-check"></i><b>1</b> Genética de Poblaciones</a>
<ul>
<li class="chapter" data-level="1.1" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#lectura-de-un-archivo-vcf-con-genotipos-de-diversos-individuos"><i class="fa fa-check"></i><b>1.1</b> Lectura de un archivo VCF con genotipos de diversos individuos</a></li>
<li class="chapter" data-level="1.2" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#el-equilibrio-de-hardy-weinberg-breve-introducción-teórica"><i class="fa fa-check"></i><b>1.2</b> El equilibrio de Hardy-Weinberg (breve introducción teórica)</a>
<ul>
<li class="chapter" data-level="" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#supuestos-que-asumimos-se-cumplen-para-h-w"><i class="fa fa-check"></i>Supuestos que asumimos se cumplen para H-W</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#equilibrio-de-hardy-weinberg-práctico"><i class="fa fa-check"></i><b>1.3</b> Equilibrio de Hardy-Weinberg (PRÁCTICO)</a></li>
<li class="chapter" data-level="1.4" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#pasaje-de-los-genotipos-a-forma-numérica"><i class="fa fa-check"></i><b>1.4</b> Pasaje de los genotipos a forma numérica</a></li>
<li class="chapter" data-level="1.5" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#muestras-y-poblaciones-en-nuestros-datos"><i class="fa fa-check"></i><b>1.5</b> Muestras y poblaciones en nuestros datos</a></li>
<li class="chapter" data-level="1.6" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>1.6</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#pca-sin-na-y-con-reducido-número-de-marcadores"><i class="fa fa-check"></i><b>1.6.1</b> PCA sin NA y con reducido número de marcadores</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#paquetes-específicos-para-genética-de-poblaciones-adegenet-y-hierfstat"><i class="fa fa-check"></i><b>1.7</b> Paquetes específicos para genética de poblaciones (adegenet y hierfstat)</a></li>
<li class="chapter" data-level="1.8" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#el-coeficiente-de-endocría-y-estadísticos-f-introducción-teórica"><i class="fa fa-check"></i><b>1.8</b> El Coeficiente de endocría y estadísticos <em>F</em> (introducción teórica)</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#estadísticos-f-práctico"><i class="fa fa-check"></i><b>1.8.1</b> Estadísticos <em>F</em> (práctico)</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#anális-de-pca-usando-paquetes-de-genética-de-poblaciones"><i class="fa fa-check"></i><b>1.9</b> Anális de PCA usando paquetes de genética de poblaciones</a></li>
<li class="chapter" data-level="1.10" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#otra-forma-de-hacer-pca"><i class="fa fa-check"></i><b>1.10</b> OTRA FORMA DE HACER PCA</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#imputación"><i class="fa fa-check"></i><b>1.10.1</b> IMPUTACIÓN</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#ensembl-y-biomart"><i class="fa fa-check"></i><b>1.11</b> ENSEMBL y biomaRt</a></li>
<li class="chapter" data-level="1.12" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#h-w-la-frecuencia-de-heterocigotas-en-función-de-la-frecuencia-alélica-intro-teórica"><i class="fa fa-check"></i><b>1.12</b> H-W: la frecuencia de heterocigotas en función de la frecuencia alélica (intro teórica)</a></li>
<li class="chapter" data-level="1.13" data-path="genética-de-poblaciones.html"><a href="genética-de-poblaciones.html#heterocigosidad"><i class="fa fa-check"></i><b>1.13</b> Heterocigosidad</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="epidemio.html"><a href="epidemio.html"><i class="fa fa-check"></i><b>2</b> Epidemiología Genética</a>
<ul>
<li class="chapter" data-level="2.1" data-path="epidemio.html"><a href="epidemio.html#la-estimación-de-frecuencias-y-el-equilibrio-o-no"><i class="fa fa-check"></i><b>2.1</b> La estimación de frecuencias y el equilibrio (o no)</a></li>
<li class="chapter" data-level="2.2" data-path="epidemio.html"><a href="epidemio.html#el-sistema-abo-introducción-teórica"><i class="fa fa-check"></i><b>2.2</b> El sistema ABO (introducción teórica)</a></li>
<li class="chapter" data-level="2.3" data-path="epidemio.html"><a href="epidemio.html#la-estimación-de-frecuencias-en-el-locus-abo"><i class="fa fa-check"></i><b>2.3</b> La estimación de frecuencias en el locus ABO</a></li>
<li class="chapter" data-level="2.4" data-path="epidemio.html"><a href="epidemio.html#clinvar"><i class="fa fa-check"></i><b>2.4</b> ClinVar</a></li>
<li class="chapter" data-level="2.5" data-path="epidemio.html"><a href="epidemio.html#estudios-de-asociación-de-genoma-completo-gwas"><i class="fa fa-check"></i><b>2.5</b> Estudios de Asociación de Genoma Completo (GWAS)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Human Whole Exome Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="genética-de-poblaciones" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Capítulo 1</span> Genética de Poblaciones<a href="genética-de-poblaciones.html#genética-de-poblaciones" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lectura-de-un-archivo-vcf-con-genotipos-de-diversos-individuos" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Lectura de un archivo VCF con genotipos de diversos individuos<a href="genética-de-poblaciones.html#lectura-de-un-archivo-vcf-con-genotipos-de-diversos-individuos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En general, un tipo de formato de archivos ampliamente utilizado en genómica es el VCF que resumen la información de variantes en un solo archivo. Este formato permite la posibilidad de informar <em>in-extenso</em> sobre un solo genoma/exoma o de incluir menos información pero para un número muy grande de genomas. Al no tratarse de un formato totalmente tabular ni totalmente “taggueado” (<strong>markup language</strong>), es conveniente utilizar alguna función específica para leer este tipo de archivos. Para eso, vamos a cargar un par de paquetes que poseen esas capacidades y en principio vamos a trabajar con las funciones del paquete “vcfR”.</p>
<hr />
<p><strong>¡Importante!</strong> La función <em>setwd()</em> sirve para cambiar el directorio de trabajo en <strong>R</strong> y debés utilizar el camino correcto en tu máquina que lleve a los datos (en caso de dudas puedes consultar a los docentes del curso).</p>
<hr />
<p>Luego de cargar los paquetes y de cambiar de directorio al directorio de trabajo, finalmente usando la función <em>read.vcfR()</em> vamos a leer el archivo con formato VCF y cargar los datos en un objeto llamado “vcf”. Si deseas ver la evolución a medida de que se va leyendo el archivo (nosotros lo deshabilitamos para no generar una salida molesta en este tutorial), alcanza con cambiar a <strong>verbose=TRUE</strong> en la función <em>read.vcfR()</em>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="genética-de-poblaciones.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9876543</span>)</span>
<span id="cb1-2"><a href="genética-de-poblaciones.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="genética-de-poblaciones.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;vcfR&quot;</span>)</span>
<span id="cb1-4"><a href="genética-de-poblaciones.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;PopGenome&quot;</span>)</span>
<span id="cb1-5"><a href="genética-de-poblaciones.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="genética-de-poblaciones.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/cursos/cursoHumanWholeExomeAnalysis2022/data/&quot;</span>)</span>
<span id="cb1-7"><a href="genética-de-poblaciones.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="genética-de-poblaciones.html#cb1-8" aria-hidden="true" tabindex="-1"></a>vcf <span class="ot">&lt;-</span> <span class="fu">read.vcfR</span>(<span class="st">&quot;native_charrua_samtools_thin20.vcf&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-9"><a href="genética-de-poblaciones.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vcf)</span></code></pre></div>
<pre><code>## [1] &quot;vcfR&quot;
## attr(,&quot;package&quot;)
## [1] &quot;vcfR&quot;</code></pre>
<p>Ahora, en el <strong>objeto</strong> “vcf” perteneciente a la clase “vcfR” tenemos almacenada toda la información de nuestro archivo (formato VCF). Para estudiar un poco el contenido de este archivo podemos en un principio ver los nombres de los “slots” del mismo y luego explorar estos con mucha cautela.</p>
<hr />
<p><strong>¡Importante!</strong> La cantidad de datos almacenada en estos objetos puede ser enorme y por lo tanto cualquier llamado a la visualización (mostrar en pantalla) el contenido completo puede ser catastrófico para la sesión de R.</p>
<hr />
<p>Para explorar con cautela los datos, muchas veces es útil utilizar la función <em>head()</em>, pero en nuestro caso también esa función puede darnos problemas con tablas masivas, de muchas columnas, en cuyo caso es mucho mejor subsetear dichas tablas.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="genética-de-poblaciones.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">attributes</span>(vcf))</span></code></pre></div>
<pre><code>## [1] &quot;meta&quot;  &quot;fix&quot;   &quot;gt&quot;    &quot;class&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="genética-de-poblaciones.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vcf<span class="sc">@</span>meta)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="genética-de-poblaciones.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(vcf<span class="sc">@</span>meta)</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="genética-de-poblaciones.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vcf<span class="sc">@</span>meta)</span></code></pre></div>
<pre><code>## [1] &quot;##fileformat=VCFv4.2&quot;             &quot;##fileDate=20221109&quot;             
## [3] &quot;##source=PLINKv1.90&quot;              &quot;##contig=&lt;ID=1,length=249210708&gt;&quot;
## [5] &quot;##contig=&lt;ID=2,length=242919946&gt;&quot; &quot;##contig=&lt;ID=3,length=197794285&gt;&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="genética-de-poblaciones.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vcf<span class="sc">@</span>fix)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="genética-de-poblaciones.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(vcf<span class="sc">@</span>fix)</span></code></pre></div>
<pre><code>## [1] 72820     8</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="genética-de-poblaciones.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vcf<span class="sc">@</span>fix)</span></code></pre></div>
<pre><code>##      CHROM POS       ID          REF ALT QUAL FILTER INFO
## [1,] &quot;1&quot;   &quot;1087683&quot; &quot;rs9442380&quot; &quot;2&quot; &quot;4&quot; NA   NA     &quot;PR&quot;
## [2,] &quot;1&quot;   &quot;1156131&quot; &quot;rs2887286&quot; &quot;2&quot; &quot;4&quot; NA   NA     &quot;PR&quot;
## [3,] &quot;1&quot;   &quot;1892325&quot; &quot;rs2803291&quot; &quot;2&quot; &quot;4&quot; NA   NA     &quot;PR&quot;
## [4,] &quot;1&quot;   &quot;2033256&quot; &quot;rs908742&quot;  &quot;3&quot; &quot;1&quot; NA   NA     &quot;PR&quot;
## [5,] &quot;1&quot;   &quot;2089526&quot; &quot;rs262654&quot;  &quot;3&quot; &quot;1&quot; NA   NA     &quot;PR&quot;
## [6,] &quot;1&quot;   &quot;2173504&quot; &quot;rs263526&quot;  &quot;4&quot; &quot;2&quot; NA   NA     &quot;PR&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="genética-de-poblaciones.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vcf<span class="sc">@</span>gt)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="genética-de-poblaciones.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(vcf<span class="sc">@</span>gt)</span></code></pre></div>
<pre><code>## [1] 72820  2362</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="genética-de-poblaciones.html#cb21-1" aria-hidden="true" tabindex="-1"></a>(vcf<span class="sc">@</span>gt)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##       FORMAT 1_C1  2_C2  3_C3  4_C4  5_C5  6_C6  7_C7  8_C8  9_C9 
##  [1,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;0/0&quot;
##  [2,] &quot;GT&quot;   &quot;1/1&quot; &quot;0/0&quot; &quot;1/1&quot; &quot;1/1&quot; &quot;1/1&quot; &quot;0/1&quot; &quot;1/1&quot; &quot;0/1&quot; &quot;0/1&quot;
##  [3,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/0&quot; &quot;1/1&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;1/1&quot;
##  [4,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot;
##  [5,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/1&quot;
##  [6,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/1&quot; &quot;0/0&quot;
##  [7,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot;
##  [8,] &quot;GT&quot;   &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot;
##  [9,] &quot;GT&quot;   &quot;0/0&quot; &quot;0/1&quot; &quot;0/0&quot; &quot;1/1&quot; &quot;0/1&quot; &quot;1/1&quot; &quot;1/1&quot; &quot;0/0&quot; &quot;1/1&quot;
## [10,] &quot;GT&quot;   &quot;0/1&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot; &quot;0/0&quot;</code></pre>
<p><strong>¿Qué representan las filas y las columnas de la tabla “gt”?</strong></p>
<p>En general también, no es necesario trabajar con todos los cromosomas a la vez (ya que el número de marcadores e individuos suele complicar el acceso a la memoria) y existe la posibilidad en este paquete de separar los distintos cromosomas y luego poder trabajar con ellos. La siguiente es la forma de hacerlo, pero como nosotros no la vamos a usar (en cambio, cuando sea necesario vamos a elegir un juego reducido y aleatorio de marcadores), si tu máquina no posee suficiente memoria no es necesario que ejecutes el siguiente “chunk”:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="genética-de-poblaciones.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="cn">FALSE</span>) {</span>
<span id="cb23-2"><a href="genética-de-poblaciones.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="do">### CROMOSOMAS PRESENTES</span></span>
<span id="cb23-3"><a href="genética-de-poblaciones.html#cb23-3" aria-hidden="true" tabindex="-1"></a>myChroms <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">getCHROM</span>(vcf))</span>
<span id="cb23-4"><a href="genética-de-poblaciones.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="genética-de-poblaciones.html#cb23-5" aria-hidden="true" tabindex="-1"></a>liChrVCF<span class="ot">&lt;-</span><span class="fu">lapply</span>(myChroms,<span class="cf">function</span>(x) vcf[<span class="fu">getCHROM</span>(vcf)<span class="sc">==</span>x, ])</span>
<span id="cb23-6"><a href="genética-de-poblaciones.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(liChrVCF)<span class="ot">&lt;-</span>myChroms</span>
<span id="cb23-7"><a href="genética-de-poblaciones.html#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="genética-de-poblaciones.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="genética-de-poblaciones.html#cb23-9" aria-hidden="true" tabindex="-1"></a>lichr<span class="ot">&lt;-</span><span class="fu">lapply</span>(liChrVCF,create.chromR,<span class="at">name=</span><span class="st">&quot;CHROM&quot;</span>)</span>
<span id="cb23-10"><a href="genética-de-poblaciones.html#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="genética-de-poblaciones.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># MÁQUINAS CON PROBLEMA DE MEMORIA</span></span>
<span id="cb23-12"><a href="genética-de-poblaciones.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ATENCIÓN: PARA QUEDARSE SOLO CON LOS CROMOSOMAS 1 y 2 HACER LO SIGUIENTE</span></span>
<span id="cb23-13"><a href="genética-de-poblaciones.html#cb23-13" aria-hidden="true" tabindex="-1"></a>vcf<span class="ot">&lt;-</span>vcf[<span class="fu">getCHROM</span>(vcf)<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), ]</span>
<span id="cb23-14"><a href="genética-de-poblaciones.html#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="genética-de-poblaciones.html#cb23-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Volvamos al conjunto de todos nuestros datos, que teníamos almacenados en un objeto de clase “vcfR”. Solamente por comodidad futura, vamos a cargar el contenido de los distintos “slots” en diferentes objetos de tipo básico (<em>data.frame</em>, por ejemplo).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="genética-de-poblaciones.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de los SNPS: verificamos que no hay cromosomas sexuales ni MT</span></span>
<span id="cb24-2"><a href="genética-de-poblaciones.html#cb24-2" aria-hidden="true" tabindex="-1"></a>snps<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(vcf<span class="sc">@</span>fix)</span></code></pre></div>
<p>Veamos ahora si podemos caracterizar un poco mejor nuestros datos. <strong>¿Cuántos y cuáles cromosomas están presentes en nuestros datos?</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="genética-de-poblaciones.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(snps<span class="sc">$</span>CHROM)</span></code></pre></div>
<pre><code>## 
##    1   10   11   12   13   14   15   16   17   18   19    2   20   21   22    3 
## 5793 3964 3649 3531 2745 2477 2281 2183 1968 2205 1212 6066 1977 1093 1075 5108 
##    4    5    6    7    8    9 
## 4288 4610 5005 4052 4043 3495</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="genética-de-poblaciones.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(snps<span class="sc">$</span>REF)</span></code></pre></div>
<pre><code>## 
##     1     2     3     4 
## 17133 19150 18999 17538</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="genética-de-poblaciones.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(snps<span class="sc">$</span>ALT)</span></code></pre></div>
<pre><code>## 
##     1     2     3     4 
## 18973 17538 17133 19176</code></pre>
<p><strong>¿Se distribuyen al azar los alelos en los cromosomas? ¿Cuál sería una forma de definir esto en términos estadísticos?</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="genética-de-poblaciones.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(snps<span class="sc">$</span>CHROM,snps<span class="sc">$</span>REF))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  table(snps$CHROM, snps$REF)
## X-squared = 99.657, df = 63, p-value = 0.00223</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="genética-de-poblaciones.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(snps<span class="sc">$</span>CHROM,snps<span class="sc">$</span>ALT))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  table(snps$CHROM, snps$ALT)
## X-squared = 97.864, df = 63, p-value = 0.003218</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="genética-de-poblaciones.html#cb35-1" aria-hidden="true" tabindex="-1"></a>tabAleChr<span class="ot">&lt;-</span><span class="fu">table</span>(snps<span class="sc">$</span>CHROM,snps<span class="sc">$</span>REF)</span>
<span id="cb35-2"><a href="genética-de-poblaciones.html#cb35-2" aria-hidden="true" tabindex="-1"></a>tabAleChr.rel<span class="ot">&lt;-</span>tabAleChr<span class="sc">/</span><span class="fu">apply</span>(tabAleChr,<span class="dv">1</span>,sum)</span>
<span id="cb35-3"><a href="genética-de-poblaciones.html#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="genética-de-poblaciones.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tabAleChr.rel)</span></code></pre></div>
<pre><code>##     
##              1         2         3         4
##   1  0.2247540 0.2775764 0.2584153 0.2392543
##   10 0.2290616 0.2648840 0.2600908 0.2459637
##   11 0.2288298 0.2628117 0.2682927 0.2400658
##   12 0.2393090 0.2557349 0.2596998 0.2452563
##   13 0.2404372 0.2765027 0.2437158 0.2393443
##   14 0.2341542 0.2507065 0.2676625 0.2474768</code></pre>
<p><strong>¿Cómo están codificados los alelos (bases) en la tabla de SNPs?</strong> Una forma de resolver esto sería elegir un par de SNPs con diferentes alelos referencia y alternativo y luego ver en las bases de datos (puedes usasr la web) las bases involucradas. <strong>¿Existe un “mapeo” aparente entre la codificación numérica utilizada y las 4 bases?</strong></p>
<p><strong>¿Te da alguna pista la siguiente tabla?</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="genética-de-poblaciones.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(snps<span class="sc">$</span>REF,snps<span class="sc">$</span>ALT)</span></code></pre></div>
<pre><code>##    
##         1     2     3     4
##   1     0   242 16891     0
##   2   207     0     0 18943
##   3 18766     0     0   233
##   4     0 17296   242     0</code></pre>
<p><strong>¿Existe alguna relación con el contenido G+C de los cromosomas?</strong></p>
<p>Veamos ahora nuestra tabla de genotipos y si podemos hacer una tabla con la frecuencia absoluta y relativa de los distintos genotipos por marcador. Para ello vamos a usar la función <em>table()</em> que ya usamos previamente y que nos realiza una tabla de conteo de los datos. Un punto importante a verificar previamente, que no lo vamos a hacer en este caso, es que se trate de marcadores bi-alélicos, ya que de lo contrario aparecerían más de 3 genotipos posibles. En nuestro caso, todos los marcadores son bi-alélicos y por lo tanto los tres genotipos posibles se codifican “0/0” (homocigoto de referencia), “0/1” heterocigoto y “1/1” (homocigoto alternativo).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="genética-de-poblaciones.html#cb39-1" aria-hidden="true" tabindex="-1"></a>genot<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(vcf<span class="sc">@</span>gt)</span>
<span id="cb39-2"><a href="genética-de-poblaciones.html#cb39-2" aria-hidden="true" tabindex="-1"></a>genot<span class="ot">&lt;-</span>genot[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb39-3"><a href="genética-de-poblaciones.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(genot)<span class="ot">&lt;-</span>snps<span class="sc">$</span>ID</span>
<span id="cb39-4"><a href="genética-de-poblaciones.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="genética-de-poblaciones.html#cb39-5" aria-hidden="true" tabindex="-1"></a>mita<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(genot,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">table</span>(x)[<span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>)]))</span>
<span id="cb39-6"><a href="genética-de-poblaciones.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mita)<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;geno&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb39-7"><a href="genética-de-poblaciones.html#cb39-7" aria-hidden="true" tabindex="-1"></a>mita[<span class="fu">is.na</span>(mita)]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb39-8"><a href="genética-de-poblaciones.html#cb39-8" aria-hidden="true" tabindex="-1"></a>mita.rel<span class="ot">&lt;-</span>mita<span class="sc">/</span><span class="fu">apply</span>(mita,<span class="dv">1</span>,sum)</span></code></pre></div>
<p>Veamos el contenido de estas dos tablas que generamos.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="genética-de-poblaciones.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mita)</span></code></pre></div>
<pre><code>##           geno0/0 geno0/1 geno1/1
## rs9442380    1634     601     125
## rs2887286     925     841     588
## rs2803291    1662     600      97
## rs908742      875     990     487
## rs262654     1407     717     230
## rs263526     1144     896     317</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="genética-de-poblaciones.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mita.rel)</span></code></pre></div>
<pre><code>##             geno0/0   geno0/1    geno1/1
## rs9442380 0.6923729 0.2546610 0.05296610
## rs2887286 0.3929482 0.3572642 0.24978760
## rs2803291 0.7045358 0.2543451 0.04111912
## rs908742  0.3720238 0.4209184 0.20705782
## rs262654  0.5977060 0.3045879 0.09770603
## rs263526  0.4853627 0.3801443 0.13449300</code></pre>
<p>La columna del medio representa la frecuencia (absoluta o relativa, dependiendo de la tabla) de los heterocigotas. Veamos como es la proporción de heterocigotas en cada marcador:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="genética-de-poblaciones.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mita.rel[,<span class="dv">2</span>],<span class="dv">40</span>,<span class="at">xlab=</span><span class="st">&quot;Heterocigosidad&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk54-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="genética-de-poblaciones.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mita.rel[,<span class="dv">1</span>]<span class="sc">+</span>(mita.rel[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>,mita.rel[,<span class="dv">2</span>],<span class="at">cex=</span><span class="fl">0.1</span>,<span class="at">xlab=</span><span class="st">&quot;Frecuencia alelo REF&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia relativa Heterocigotos&quot;</span>)</span>
<span id="cb45-2"><a href="genética-de-poblaciones.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-3"><a href="genética-de-poblaciones.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mita.rel[,<span class="dv">1</span>]<span class="sc">+</span>(mita.rel[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">*</span>(mita.rel[,<span class="dv">1</span>]<span class="sc">+</span>(mita.rel[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(mita.rel[,<span class="dv">3</span>]<span class="sc">+</span>(mita.rel[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="fl">0.1</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk54-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="genética-de-poblaciones.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>¿Se encuentran los distintos marcadores en equilibrio de Hardy-Weinberg?</strong></p>
<p>En particular, el archivo con el que estamos trabajando se trata de un subconjunto de marcadores (SNPs) en diferentes individuos, los que pertenecen a su vez a diferentes poblaciones. Se trata de un sub-conjunto de los marcadores ya que el total de los marcadores con información en muchísimo mayor y dificulta el trabajarlo a nivel de un práctico con máquinas de escasa memoria y capacidad de procesador. Más aún, si bien elegimos trabajar desde R para poder explorar mejor todos los pasos, existen otras alternativas de “software” que permiten cálculos más eficientes cuando los volúmenes de datos son masivos. Algunos de ellos, como <strong>plink</strong>, permiten trabajar desde R con facilidad (<a href="https://www.cog-genomics.org/plink/1.9/rserve" class="uri">https://www.cog-genomics.org/plink/1.9/rserve</a>).</p>
<hr />
<hr />
</div>
<div id="el-equilibrio-de-hardy-weinberg-breve-introducción-teórica" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> El equilibrio de Hardy-Weinberg (breve introducción teórica)<a href="genética-de-poblaciones.html#el-equilibrio-de-hardy-weinberg-breve-introducción-teórica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La “ley de Hardy-Weinberg”, a veces conocida también como de
Hardy-Weinberg-Castle por los trabajos de <span class="citation">Castle (<a href="#ref-castle1903" role="doc-biblioref">1903</a>)</span>, <span class="citation">Hardy (<a href="#ref-pmid17779291" role="doc-biblioref">1908</a>)</span>
y <span class="citation">Weinberg (<a href="#ref-weinberg1908" role="doc-biblioref">1908</a>)</span>,<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> es posiblemente uno de los resultados mejor
conocidos de la genética de poblaciones. La misma permite predecir la
composición de genotipos en un locus determinado, una vez alcanzado el
equilibrio, a partir de la frecuencia de los alelos, cuando se cumplen
una serie de condiciones, básicamente el apareamiento aleatorio entre
los individuos de la población. La base de la misma es conceptualmente
sencilla: en un individuo diploide, la probabilidad de observar un
genotipo en particular en un locus autosómico determinado (es decir, no
se encuentra en los cromosomas “sexuales”) es el producto de la
frecuencia de los gametos que lo formaron. Pongamos un ejemplo sencillo
para mostrarlo; supongamos un <u>locus autosómico</u> con dos alelos,
<span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span>, con frecuencias <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> (siendo <span class="math inline">\(q=1-p\)</span> donde la suma de las frecuencias
de los dos alelos debe ser 1 ya que asumimos que este locus solo tiene 2
alelos). Más aún, supongamos que se trata de una especie diploide
hermafrodita, es decir, todos los individuos producen gametos masculinos
y femeninos y para simplificar aún más asumamos que estos gametos se
colocan en dos “pools”, uno de gametos masculinos y otro de gametos
femeninos, todos los individuos produciendo exactamente la misma
cantidad de gametos (para simplificar el efecto del tamaño poblacional
asumimos también que dos gametos provenientes del mismo individuo, uno
masculino y otro femenino se pueden combinar). Finalmente, aseguremos
que los apareamientos sean completamente al azar, una condición que se
conoce como <strong>panmixia</strong>. Para “crear” los individuos de la nueva
generación extraemos un gameto de cada “pool”. Por lo tanto, la
probabilidad de cada genotipo estará dada por la probabilidad de extraer
esa combinación, que al tratarse de eventos independientes (el gameto
masculino del femenino) es el producto de ambas probabilidades. Es
decir:</p>
<p><span class="math display" id="eq:eqHW">\[\begin{equation}
\begin{split}
P(A_1A_1)=P(A_1)\cdot P(A_1)=p\cdot p=p^2\\
P(A_1A_2)=2\cdot P(A_1)\cdot P(A_2)=2\cdot p\cdot q=2pq\\
P(A_2A_2)=P(A_2)\cdot P(A_2)=q\cdot q=q^2\\
\end{split}
\tag{1.1}
\end{equation}\]</span></p>
<p>que es la expresión más sencilla de la ley de Hardy-Weinberg. Es de
notar que el factor 2 que aparece multiplicando la frecuencia de los
genotipos heterocigotos (<span class="math inline">\(A_1A_2\)</span>) se debe a que existen dos formas de
obtener estos individuos: a) sacando un alelo <span class="math inline">\(A_1\)</span> del “pool” masculino
y un <span class="math inline">\(A_2\)</span> del “pool” femenino y b) sacando un alelo <span class="math inline">\(A_2\)</span> del “pool”
masculino y un <span class="math inline">\(A_1\)</span> del “pool” femenino, ambas con la misma
probabilidad (<span class="math inline">\(pq\)</span>).<br />
</p>
<p>Lo primero que debemos verificar es que estas <strong>frecuencias sumen a 1</strong>, ya
que no existen otros genotipos posibles (recordemos que <span class="math inline">\(q=1-p\)</span>):</p>
<p><span class="math display">\[\begin{equation}
p^2+2pq+q^2=p^2+2p(1-p)+(1-p)^2=p^2+2p-2p^2+1-2p+p^2=\\
=(2p^2-2p^2)+(2p-2p)+1=0+0+1=1
\end{equation}\]</span></p>
<p>Una vez verificado esto,
el siguiente paso será determinar las nuevas frecuencias de los alelos
<span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span>, llamémosles <span class="math inline">\(p&#39;\)</span> y <span class="math inline">\(q&#39;\)</span>. Lo podemos hacer sumando los
aportes de alelos de cada genotipo (los heterocigotos aportan la mitad
de su frecuencia para cada tipo de alelo, <span class="math inline">\(A_1\)</span> y <span class="math inline">\(A_2\)</span>, mientras que
los homocigotos aportan toda su frecuencia del respectivo alelo):</p>
<p><span class="math display">\[\begin{equation}
p&#39;=p^2+\frac{1}{2} 2pq=p^2+pq=p(p+q)=p(1)=p\\
q&#39;=q^2+\frac{1}{2} 2pq=q^2+pq=q(q+p)=q(1)=q
\end{equation}\]</span></p>
<p>Por lo tanto, después de una generación bajo este apareamiento al azar
en nuestra especie hermafrodita, las frecuencias alélicas permanecen
inalteradas, <span class="math inline">\(p=p&#39;\)</span> y <span class="math inline">\(q=q&#39;\)</span>. Obviamente ocurrirá lo mismo para las
siguientes generaciones, tanto a nivel de la frecuencia de los genotipos
como de los alelos (las frecuencias de los genotipos solo dependen de
las frecuencias de los alelos, como vimos en la ecuaciones
<a href="genética-de-poblaciones.html#eq:eqHW">(1.1)</a> y siguientes), por lo que luego de una generación hemos alcanzado el
equilibrio: esta condición se conoce como <strong>equilibrio de Hardy-Weinberg</strong>.</p>
<p><br />
</p>
<pre><code>## 
## Attaching package: &#39;grid&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ff&#39;:
## 
##     pattern</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:HWpunnett"></span>
<img src="HWEA2022_files/figure-html/HWpunnett-1.png" alt="Cuadrado de Punnett con frecuencias $p=0,6$ y $q=0,4$. Las áreas de los rectángulos/cuadrados representan las frecuencias de los genotipos. Figura tomada de Wikipedia (CC0), modificada a partir de @pmid26354973" width="480" />
<p class="caption">
Figura 1.1: Cuadrado de Punnett con frecuencias <span class="math inline">\(p=0,6\)</span> y <span class="math inline">\(q=0,4\)</span>. Las áreas de los rectángulos/cuadrados representan las frecuencias de los genotipos. Figura tomada de Wikipedia (CC0), modificada a partir de <span class="citation">Rosenberg and Kang (<a href="#ref-pmid26354973" role="doc-biblioref">2015</a>)</span>
</p>
</div>
<p><br />
</p>
<p>Una forma gráfica de ver estos resultados son los llamados “cuadrados de
Punnett”<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>, como el que se aprecia en la figura <a href="genética-de-poblaciones.html#fig:HWpunnett">1.1</a>.
En la misma, en el eje horizontal tenemos la frecuencia con la que
aparecen los gametos masculinos, mientras que en el vertical aparecen
las frecuencias de los gametos femeninos; por lo tanto, el producto de
estas frecuencias será el área de los rectángulos y cuadrados
correspondientes (de geometría elemental, el área de cuadrados y
rectángulos es el producto de dos lados contiguos). Se observa además
claramente el origen del factor 2 en los heterocigotos (la suma de las 2
áreas coloreadas en rojo, cada una con valor <span class="math inline">\(pq\)</span>).</p>
<p><br />
</p>
<p><strong>Si tenemos un <em>locus</em> con <span class="math inline">\(n\)</span> alelos:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>¿Cuántos genotipos posibles tenemos?</strong></p></li>
<li><p><strong>¿Cuáles son las frecuencias esperadas para los distintos genotipos?</strong></p></li>
</ol>
<p>Ayuda: comenzar con <span class="math inline">\(n=3\)</span> en un cuadrado de Punnett y luego pasar a la generalización.</p>
<hr />
<div id="supuestos-que-asumimos-se-cumplen-para-h-w" class="section level3 unnumbered hasAnchor">
<h3>Supuestos que asumimos se cumplen para H-W<a href="genética-de-poblaciones.html#supuestos-que-asumimos-se-cumplen-para-h-w" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Todos los genotipos poseen el mismo “fitness” (es decir, ningún genotipo posee una ventaja respecto al número de descendientes que deja)</p></li>
<li><p>La población debe estar formada por un número infinitamente grande de individuos</p></li>
<li><p>El apareamiento al azar debe producirse en toda la población</p></li>
<li><p>No debe existir migración que altere las frecuencias</p></li>
<li><p>Debe existir un equilibrio mutacional (es decir, las frecuencias de los alelos no varían pese a existir mutaciones).</p></li>
</ol>
<hr />
<p><br />
</p>
</div>
</div>
<div id="equilibrio-de-hardy-weinberg-práctico" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Equilibrio de Hardy-Weinberg (PRÁCTICO)<a href="genética-de-poblaciones.html#equilibrio-de-hardy-weinberg-práctico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En general, el apartamiento (en términos estadísticos) del equilibrio de Hardy-Weinberg representa el apartamiento de alguna de las condiciones que asumimos, por ejemplo la <strong>panmixia</strong>, o la ausencia de <strong>selección diferencial para los genotipos</strong> involucrados (así sea directamente o por desequilibrio de ligamiento), etc. En este sentido, es una práctica usual (aunque discutida) en predicción genómica el depurar el juego de marcadores utilizado, eliminando aquellos que se apartan significativamente de lo esperado para el equilibrio Hardy-Weinberg. Veamos si en nuestros datos los marcadores se encuentran en equilibrio de Hardy-Weinberg.</p>
<p>Para eso, lo primero que vamos a hacer es crear una función que dadas las frecuencias absolutas de los 3 genotipos de cada marcador (en forma ordenada, “0/0”, “0/1” y “1/1”) me genera una tabla con las frecuencias esperadas y las observadas.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="genética-de-poblaciones.html#cb49-1" aria-hidden="true" tabindex="-1"></a>eqHWtabla<span class="ot">&lt;-</span><span class="cf">function</span>(x){xt<span class="ot">&lt;-</span><span class="fu">sum</span>(x);p<span class="ot">&lt;-</span>(x[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>xt;y<span class="ot">&lt;-</span><span class="fu">c</span>(p<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>xt,<span class="dv">2</span><span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>xt,xt<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span><span class="dv">2</span>);ta<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y);<span class="fu">rownames</span>(ta)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Ho&quot;</span>,<span class="st">&quot;He&quot;</span>);ta}</span></code></pre></div>
<p>La lógica de esta función es sencilla: calcular la frecuencia <span class="math inline">\(p\)</span> de un alelo (el otro queda determinado como <span class="math inline">\(q=1-p\)</span>) y a partir de esto calcular las <strong>frecuencias absolutas esperadas</strong> como <span class="math inline">\(xt\times p^2\)</span>, <span class="math inline">\(xt \times 2p(1-p)\)</span> y <span class="math inline">\(xt \times (1-p)^2\)</span>, donde <span class="math inline">\(xt\)</span> es la suma de las frecuencias de los genotipos. Finalmente, devuelve una tabla donde la primera fila se corresponde con las <strong>frecuencias absolutas observadas</strong> y la segunda con las <strong>frecuencias absolutas esperadas</strong>.</p>
<p>Veamos que ocurre si le aplicamos esta función a uno de los marcadores (por ejemplo, al primero) cuyas frecuencias genotípicas calculamos previamente.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="genética-de-poblaciones.html#cb50-1" aria-hidden="true" tabindex="-1"></a>mita[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>## geno0/0 geno0/1 geno1/1 
##    1634     601     125</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="genética-de-poblaciones.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eqHWtabla</span>(mita[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>##     geno0/0  geno0/1   geno1/1
## Ho 1634.000 601.0000 125.00000
## He 1585.716 697.5676  76.71621</code></pre>
<p>Si quisiéramos ahora conocer si las frecuencias observadas coinciden con las esperadas para el equilibrio de Hardy-Weinberg podríamos realizar un test sobre esta tabla, por el ejemplo el de <span class="math inline">\(\chi^2\)</span>, y observar el “p-value” correspondiente</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="genética-de-poblaciones.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">eqHWtabla</span>(mita[<span class="dv">1</span>,]))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  eqHWtabla(mita[1, ])
## X-squared = 19.463, df = 2, p-value = 5.939e-05</code></pre>
<p>Podemos ahora aplicar la función a todos los marcadores y obtener un vector con los <em>p-valores</em> correspondientes a cada marcador</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="genética-de-poblaciones.html#cb56-1" aria-hidden="true" tabindex="-1"></a>HWmarcadores<span class="ot">&lt;-</span><span class="fu">apply</span>(mita,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">chisq.test</span>(<span class="fu">eqHWtabla</span>(x))<span class="sc">$</span>p.value)</span></code></pre></div>
<p>En este caso, utilizamos la función <em>apply()</em> sobre la tabla completa de genotipos de los marcadores. Esta función toma la tabla como primer argumento, el segundo especifica si quiero trabajar sobre filas (1) o sobre columnas (2) y el tercer argumento especifica la función que quiero aplicar. Como en nuestro caso queremos aplicar la composición de dos funciones, es decir aplicarle la función <em>chisq.test()</em> al resultados de la función <em>eqHWtabla()</em>, entonces especificamos que para cada fila <em>x</em> vamos a calcular <em>chisq.test(eqHWtabla(x))</em> y de eso quedarnos con el resultado almacenado en el ‘slot’ <em>p.value</em>.</p>
<p>Veamos la distribución de los valores <em>p</em> para el conjunto de marcadores. Una manera sencilla es realizar un histograma, lo que conseguimos con</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="genética-de-poblaciones.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(HWmarcadores,<span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;HW en marcadores&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;p-values&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk104-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Normalmente, cuando la distribución de los genotipos observada en los distintos marcadores sigue aproximadamente las frecuencias esperadas para el equilibrio de Hardy-Weinberg, la distribución de los p-valores se asemeja a una distribución uniforme. En nuestro caso, esto es claramente diferente a lo que observamos, donde tenemos un número enorme de marcadores que aparecen como significativos en primera instancia. Podemos ver la proporción de los mismos que aparece como por debajo del umbral <span class="math inline">\(0.01\)</span> haciendo</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="genética-de-poblaciones.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HWmarcadores<span class="sc">&lt;</span><span class="fl">1e-2</span>)<span class="sc">/</span><span class="fu">length</span>(HWmarcadores)</span></code></pre></div>
<pre><code>## [1] 0.5193491</code></pre>
<p>Obviamente, como tenemos miles de marcadores, si fijamos un umbral para determinar la significancia de los p-valores obtenidos, la probabilidad de observar por azarvalores inferiores al umbral se incrementa en forma sustancial y debemos corregir los mismos por el efecto de ensayos múltiples (“multiple testing”). Una alternativa sencilla es usar la función <em>p.adjust()</em>, eligiendo el método de corrección que sea de nuestro interés. Una corrección muy drástica suele ser el método de “Bonferroni” que consiste en ajustar el valor del umbral dividiéndolo entre el número de ensayos de hipótesis, o lo que es similar, multiplicando cada <em>p-valor</em> por el número de marcadores. En nuestro caso, podemos hacer</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="genética-de-poblaciones.html#cb60-1" aria-hidden="true" tabindex="-1"></a>pval.bonferroni<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(HWmarcadores, <span class="at">method =</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb60-2"><a href="genética-de-poblaciones.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pval.bonferroni<span class="sc">&lt;</span><span class="fl">1e-2</span>)<span class="sc">/</span><span class="fu">length</span>(pval.bonferroni)</span></code></pre></div>
<pre><code>## [1] 0.1483796</code></pre>
<p>Claramente, la frecuencia de marcadores significativos bajó, pero aún así la proporción es enorme, lo que denota que en general nuestro juego de marcadores <strong>no está</strong> en equilibrio de Hardy-Weinberg.</p>
<p><strong>¿Cuál podría ser la razón?</strong></p>
<p><br />
</p>
</div>
<div id="pasaje-de-los-genotipos-a-forma-numérica" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Pasaje de los genotipos a forma numérica<a href="genética-de-poblaciones.html#pasaje-de-los-genotipos-a-forma-numérica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El formato en el que están descritos los genotipos en el archivo <strong>VCF</strong> (“0/0”, “0/1” y “1/1”) dificulta su trabajo en forma numérica. En el caso de que trabajemos con marcadores bi-estado (o bi-alélicos), es decir que solo existen dos alelos posibles para cada marcador, resulta intuitivo considerar el número de copias de unos de los dos posibles, por ejemplo el alternativo (<strong>ALT</strong>), como una variable numérica, discreta con solo 3 valores posibles:</p>
<ol style="list-style-type: lower-alpha">
<li>0 para los genotipos “0/0”</li>
<li>1 para los genotipos “0/1”</li>
<li>2 para los genotipos “1/1”</li>
</ol>
<p>Más adelante veremos como esto nos simplifica la vida, pero por ahora nos vamos a limitar a hacer dicha transformación para nuestra matriz de genotipos:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="genética-de-poblaciones.html#cb62-1" aria-hidden="true" tabindex="-1"></a>ngeno<span class="ot">&lt;-</span>genot</span>
<span id="cb62-2"><a href="genética-de-poblaciones.html#cb62-2" aria-hidden="true" tabindex="-1"></a>ngeno[ngeno<span class="sc">==</span><span class="st">&quot;0/0&quot;</span>]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb62-3"><a href="genética-de-poblaciones.html#cb62-3" aria-hidden="true" tabindex="-1"></a>ngeno[ngeno<span class="sc">==</span><span class="st">&quot;0/1&quot;</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb62-4"><a href="genética-de-poblaciones.html#cb62-4" aria-hidden="true" tabindex="-1"></a>ngeno[ngeno<span class="sc">==</span><span class="st">&quot;1/1&quot;</span>]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb62-5"><a href="genética-de-poblaciones.html#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="genética-de-poblaciones.html#cb62-6" aria-hidden="true" tabindex="-1"></a>ngenot<span class="ot">&lt;-</span><span class="fu">apply</span>(ngeno,<span class="dv">2</span>,as.numeric)</span>
<span id="cb62-7"><a href="genética-de-poblaciones.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ngenot)<span class="ot">&lt;-</span><span class="fu">rownames</span>(genot)</span>
<span id="cb62-8"><a href="genética-de-poblaciones.html#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="genética-de-poblaciones.html#cb62-9" aria-hidden="true" tabindex="-1"></a>genot[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span></code></pre></div>
<pre><code>##            1_C1 2_C2 3_C3 4_C4 5_C5 6_C6 7_C7 8_C8 9_C9 10_C10 11_HGDP00479
## rs9442380   0/0  0/1  0/0  0/0  0/1  0/0  0/0  0/1  0/0    0/1          0/0
## rs2887286   1/1  0/0  1/1  1/1  1/1  0/1  1/1  0/1  0/1    0/1          1/1
## rs2803291   0/0  0/0  1/1  0/1  0/0  0/0  0/0  0/1  1/1    0/1          0/0
## rs908742    0/0  0/0  0/0  0/1  0/1  0/0  0/0  0/0  0/1    0/1          0/0
## rs262654    0/0  0/0  0/0  0/1  0/1  0/1  0/1  0/0  0/1    0/1          0/0
## rs263526    0/0  0/1  0/1  0/1  0/1  0/1  0/1  0/1  0/0    0/1          0/1
## rs10797417  0/0  0/0  0/0  0/0  0/0  0/0  0/0  0/0  0/0    0/0          0/0
## rs11588312  0/1  0/0  0/0  0/0  0/1  0/0  0/0  0/0  0/0    0/0          0/1
## rs2017143   0/0  0/1  0/0  1/1  0/1  1/1  1/1  0/0  1/1    1/1          0/1
## rs903919    0/1  0/0  0/0  0/0  0/0  0/0  0/0  0/0  0/0    0/0          0/0
##            12_HGDP00985
## rs9442380           0/0
## rs2887286           0/0
## rs2803291           0/0
## rs908742            0/0
## rs262654            0/0
## rs263526            0/0
## rs10797417          0/1
## rs11588312          0/0
## rs2017143           0/1
## rs903919            0/0</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="genética-de-poblaciones.html#cb64-1" aria-hidden="true" tabindex="-1"></a>ngenot[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span></code></pre></div>
<pre><code>##            1_C1 2_C2 3_C3 4_C4 5_C5 6_C6 7_C7 8_C8 9_C9 10_C10 11_HGDP00479
## rs9442380     0    1    0    0    1    0    0    1    0      1            0
## rs2887286     2    0    2    2    2    1    2    1    1      1            2
## rs2803291     0    0    2    1    0    0    0    1    2      1            0
## rs908742      0    0    0    1    1    0    0    0    1      1            0
## rs262654      0    0    0    1    1    1    1    0    1      1            0
## rs263526      0    1    1    1    1    1    1    1    0      1            1
## rs10797417    0    0    0    0    0    0    0    0    0      0            0
## rs11588312    1    0    0    0    1    0    0    0    0      0            1
## rs2017143     0    1    0    2    1    2    2    0    2      2            1
## rs903919      1    0    0    0    0    0    0    0    0      0            0
##            12_HGDP00985
## rs9442380             0
## rs2887286             0
## rs2803291             0
## rs908742              0
## rs262654              0
## rs263526              0
## rs10797417            1
## rs11588312            0
## rs2017143             1
## rs903919              0</code></pre>
<p><br />
</p>
<hr />
</div>
<div id="muestras-y-poblaciones-en-nuestros-datos" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Muestras y poblaciones en nuestros datos<a href="genética-de-poblaciones.html#muestras-y-poblaciones-en-nuestros-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Investiguemos un poco más. Para ello vamos a cargar la tabla que contiene la información de las poblaciones y proyectos a los que pertenecen las distintas muestras que se encuentran en <strong>IGSR: The International Genome Sample Resource</strong> (<a href="https://www.internationalgenome.org/data-portal/sample" class="uri">https://www.internationalgenome.org/data-portal/sample</a>). No te olvides de cambair el “path” al adecuado en tu máquina.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="genética-de-poblaciones.html#cb66-1" aria-hidden="true" tabindex="-1"></a>ta<span class="ot">&lt;-</span><span class="fu">read.delim</span>(<span class="st">&quot;~/cursos/cursoHumanWholeExomeAnalysis2022/data/samples1000G.txt&quot;</span>)</span>
<span id="cb66-2"><a href="genética-de-poblaciones.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ta)</span></code></pre></div>
<pre><code>## [1] 4978    9</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="genética-de-poblaciones.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ta)</span></code></pre></div>
<pre><code>##   Sample.name    Sex Biosample.ID Population.code Population.name
## 1     HG00271   male   SAME123417             FIN         Finnish
## 2     HG00276 female   SAME123424             FIN         Finnish
## 3     HG00288 female  SAME1839246             FIN         Finnish
## 4     HG00290   male  SAME1839057             FIN         Finnish
## 5     HG00303   male  SAME1840115             FIN         Finnish
## 6     HG00308   male   SAME124161             FIN         Finnish
##   Superpopulation.code Superpopulation.name Population.elastic.ID
## 1                  EUR    European Ancestry                   FIN
## 2                  EUR    European Ancestry                   FIN
## 3                  EUR    European Ancestry                   FIN
## 4                  EUR    European Ancestry                   FIN
## 5                  EUR    European Ancestry                   FIN
## 6                  EUR    European Ancestry                   FIN
##                                                                                                       Data.collections
## 1 1000 Genomes on GRCh38,1000 Genomes 30x on GRCh38,1000 Genomes phase 3 release,1000 Genomes phase 1 release,Geuvadis
## 2 1000 Genomes on GRCh38,1000 Genomes 30x on GRCh38,1000 Genomes phase 3 release,1000 Genomes phase 1 release,Geuvadis
## 3                                       1000 Genomes on GRCh38,1000 Genomes 30x on GRCh38,1000 Genomes phase 3 release
## 4                                       1000 Genomes on GRCh38,1000 Genomes 30x on GRCh38,1000 Genomes phase 3 release
## 5                                                                                               1000 Genomes on GRCh38
## 6                              1000 Genomes on GRCh38,1000 Genomes 30x on GRCh38,1000 Genomes phase 3 release,Geuvadis</code></pre>
<p>Claramente, si nos fijamos en los identificadores de nuestras muestras (es decir, de las muestras que tenemos en la tabla de genotipos), el identificador similar al usado por el <strong>IGSR</strong> sería la secuencia de caracteres que se encuentra luego del primer guión bajo (“_“), por lo que debemos retener esa parte del identificador y ver si lo encontramos en la tabla del <strong>IGSR</strong>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="genética-de-poblaciones.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(genot)[<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;1_C1&quot;         &quot;2_C2&quot;         &quot;3_C3&quot;         &quot;4_C4&quot;         &quot;5_C5&quot;        
##  [6] &quot;6_C6&quot;         &quot;7_C7&quot;         &quot;8_C8&quot;         &quot;9_C9&quot;         &quot;10_C10&quot;      
## [11] &quot;11_HGDP00479&quot; &quot;12_HGDP00985&quot; &quot;13_HGDP01094&quot; &quot;14_HGDP00982&quot; &quot;15_HGDP00911&quot;
## [16] &quot;16_HGDP01202&quot; &quot;17_HGDP00927&quot; &quot;18_HGDP00461&quot; &quot;19_HGDP00986&quot; &quot;20_HGDP00449&quot;
## [21] &quot;21_HGDP00912&quot; &quot;22_HGDP01283&quot; &quot;23_HGDP00928&quot; &quot;24_HGDP00937&quot; &quot;25_HGDP01408&quot;
## [26] &quot;26_HGDP00991&quot; &quot;27_HGDP01031&quot; &quot;28_HGDP01263&quot; &quot;29_HGDP01275&quot; &quot;30_HGDP00611&quot;
## [31] &quot;31_HGDP00623&quot; &quot;32_HGDP00634&quot; &quot;33_HGDP00645&quot; &quot;34_HGDP00557&quot; &quot;35_HGDP00569&quot;
## [36] &quot;36_HGDP00581&quot; &quot;37_HGDP00594&quot; &quot;38_HGDP00675&quot; &quot;39_HGDP00687&quot; &quot;40_HGDP00697&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="genética-de-poblaciones.html#cb72-1" aria-hidden="true" tabindex="-1"></a>nombresengenot<span class="ot">&lt;-</span><span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">colnames</span>(genot),<span class="cf">function</span>(x)<span class="fu">strsplit</span>(x,<span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]))</span>
<span id="cb72-2"><a href="genética-de-poblaciones.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nombresengenot,<span class="dv">40</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;C1&quot;        &quot;C2&quot;        &quot;C3&quot;        &quot;C4&quot;        &quot;C5&quot;        &quot;C6&quot;       
##  [7] &quot;C7&quot;        &quot;C8&quot;        &quot;C9&quot;        &quot;C10&quot;       &quot;HGDP00479&quot; &quot;HGDP00985&quot;
## [13] &quot;HGDP01094&quot; &quot;HGDP00982&quot; &quot;HGDP00911&quot; &quot;HGDP01202&quot; &quot;HGDP00927&quot; &quot;HGDP00461&quot;
## [19] &quot;HGDP00986&quot; &quot;HGDP00449&quot; &quot;HGDP00912&quot; &quot;HGDP01283&quot; &quot;HGDP00928&quot; &quot;HGDP00937&quot;
## [25] &quot;HGDP01408&quot; &quot;HGDP00991&quot; &quot;HGDP01031&quot; &quot;HGDP01263&quot; &quot;HGDP01275&quot; &quot;HGDP00611&quot;
## [31] &quot;HGDP00623&quot; &quot;HGDP00634&quot; &quot;HGDP00645&quot; &quot;HGDP00557&quot; &quot;HGDP00569&quot; &quot;HGDP00581&quot;
## [37] &quot;HGDP00594&quot; &quot;HGDP00675&quot; &quot;HGDP00687&quot; &quot;HGDP00697&quot;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="genética-de-poblaciones.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)</span></code></pre></div>
<pre><code>## [1] 1591</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="genética-de-poblaciones.html#cb76-1" aria-hidden="true" tabindex="-1"></a>muestras.que.estan<span class="ot">&lt;-</span><span class="fu">colnames</span>(genot)[<span class="fu">which</span>(nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)]</span>
<span id="cb76-2"><a href="genética-de-poblaciones.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(muestras.que.estan)</span></code></pre></div>
<pre><code>## [1] 1591</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="genética-de-poblaciones.html#cb78-1" aria-hidden="true" tabindex="-1"></a>muestras.que.NO.estan<span class="ot">&lt;-</span><span class="fu">colnames</span>(genot)[<span class="fu">which</span>(<span class="sc">!</span>nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)]</span>
<span id="cb78-2"><a href="genética-de-poblaciones.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(muestras.que.NO.estan)</span></code></pre></div>
<pre><code>## [1] 770</code></pre>
<p>Es decir, de todas nuestras muestras, en la tabla del <strong>IGSR</strong> pudimos identificar 1591 de nuestras muestras que se encuentran en dicha tabla, mientras que 770 no se encuentran en la tabla del Proyecto 1000genomas. Vamos a subsetear nuestros datos para trabajar con las muestras que nos interesan, que en este caso son las que pudimos identificar su origen. De paso, vamos a ver como podemos utilizar el hecho de que nuestros marcadores son todo bi-alélicos para nuestro provecho.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="genética-de-poblaciones.html#cb80-1" aria-hidden="true" tabindex="-1"></a>ngenot.estan<span class="ot">&lt;-</span>ngenot[,muestras.que.estan]</span>
<span id="cb80-2"><a href="genética-de-poblaciones.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ngenot.estan)<span class="ot">&lt;-</span>nombresengenot[<span class="fu">which</span>(nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)]</span>
<span id="cb80-3"><a href="genética-de-poblaciones.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="genética-de-poblaciones.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ngenot)</span></code></pre></div>
<pre><code>## [1] 72820  2361</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="genética-de-poblaciones.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ngenot.estan)</span></code></pre></div>
<pre><code>## [1] 72820  1591</code></pre>
<p>Para facilitar las cosas vamos a reducir también nuestra tabla de muestras a solo aquellas muestras que tenemos identificadas:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="genética-de-poblaciones.html#cb84-1" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span>ta[<span class="fu">which</span>(ta<span class="sc">$</span>Sample.name<span class="sc">%in%</span>nombresengenot),]</span>
<span id="cb84-2"><a href="genética-de-poblaciones.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tb)<span class="ot">&lt;-</span>tb<span class="sc">$</span>Sample.name</span>
<span id="cb84-3"><a href="genética-de-poblaciones.html#cb84-3" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span>tb[nombresengenot[<span class="fu">which</span>(nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)],]</span>
<span id="cb84-4"><a href="genética-de-poblaciones.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb)</span></code></pre></div>
<pre><code>##           Sample.name  Sex Biosample.ID Population.code Population.name
## HGDP00479   HGDP00479 male                                        Biaka
## HGDP00985   HGDP00985 male                                        Biaka
## HGDP01094   HGDP01094 male                                        Biaka
## HGDP00982   HGDP00982 male SAMEA3302833                           Mbuti
## HGDP00911   HGDP00911 male                                     Mandenka
## HGDP01202   HGDP01202 male                                     Mandenka
##           Superpopulation.code Superpopulation.name Population.elastic.ID
## HGDP00479                             Africa (HGDP)             BiakaHGDP
## HGDP00985                             Africa (HGDP)             BiakaHGDP
## HGDP01094                             Africa (HGDP)             BiakaHGDP
## HGDP00982                             Africa (SGDP)             MbutiSGDP
## HGDP00911                             Africa (HGDP)          MandenkaHGDP
## HGDP01202                             Africa (HGDP)          MandenkaHGDP
##                          Data.collections
## HGDP00479  Human Genome Diversity Project
## HGDP00985  Human Genome Diversity Project
## HGDP01094  Human Genome Diversity Project
## HGDP00982 Simons Genome Diversity Project
## HGDP00911  Human Genome Diversity Project
## HGDP01202  Human Genome Diversity Project</code></pre>
<p>Claramente, ahora podemos apreciar que nuestros genotipos se corresponden con individuos que provienen de diferentes poblaciones. Para ver la distribución de las muestras en las diferentes poblaciones podemos hacer:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="genética-de-poblaciones.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tb<span class="sc">$</span>Population.code)</span></code></pre></div>
<pre><code>## 
##     ASW CEU CHB GIH JPT LWK MXL TSI YRI 
## 884  34 108  83  82  85  73  49  88 105</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="genética-de-poblaciones.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tb<span class="sc">$</span>Population.name)</span></code></pre></div>
<pre><code>## 
##                  Adygei     African Ancestry SW                 Balochi 
##                      17                      34                      21 
##            Bantu Herero             Bantu Kenya      Bantu South Africa 
##                       2                       9                       4 
##            Bantu Tswana                  Basque                 Bedouin 
##                       2                      24                      43 
##               Bedouin B                 Bergamo         Bergamo Italian 
##                       2                       2                       9 
##                   Biaka            Bougainville                  Brahui 
##                      21                      10                      23 
##                 Burusho               Cambodian     Cambodian,Cambodian 
##                      24                       9                       1 
##                    CEPH               Colombian                     Dai 
##                     108                       5                       9 
##                    Daur                   Druze                  French 
##                       9                      42                      27 
##                Gujarati                     Han             Han Chinese 
##                      82                      33                      83 
##                  Hazara                  Hezhen                Japanese 
##                      15                       8                     112 
##       Japanese,Japanese          Ju|&#39;hoan North      Ju|&#39;hoan North,San 
##                       1                       2                       1 
##                  Kalash               Karitiana                    Lahu 
##                      22                      11                       8 
##                   Luhya             Luhya,Luhya                 Makrani 
##                      72                       1                      20 
##                Mandenka                    Maya              Mayan,Maya 
##                      21                      15                       2 
##                   Mbuti             Mbuti,Mbuti        Mexican Ancestry 
##                      11                       2                      49 
##                    Miao                 Mongola               Mongolian 
##                      10                       2                       5 
##                Mozabite       Mozabite,Mozabite                    Naxi 
##                      24                       1                       8 
##            Northern Han                Orcadian                  Oroqen 
##                      10                      15                       9 
##             Palestinian                  Papuan            Papuan Sepik 
##                      42                       3                       1 
## Papuan,Papuan Highlands     Papuan,Papuan Sepik                  Pathan 
##                       6                       6                      21 
##           Pathan,Pathan                 Piapoco                    Pima 
##                       1                       2                      12 
##                 Russian                     San               Sardinian 
##                      25                       2                      27 
##                     She                  Sindhi                   Surui 
##                      10                      22                       8 
##                 Toscani                      Tu                   Tujia 
##                      88                      10                      10 
##                  Tuscan                   Uygur                    Xibo 
##                       8                      10                       9 
##                   Yakut                      Yi                  Yoruba 
##                      21                      10                     125</code></pre>
<p>Se aprecia que 884 muestras no tienen código de población asignado. <strong>¿A que poblaciones (“Population.name”) pertenecen dichas muestras?</strong></p>
<p>Una forma fácil de responder esta pregunta es hacer:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="genética-de-poblaciones.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tb[tb<span class="sc">$</span>Population.code<span class="sc">==</span><span class="st">&quot;&quot;</span>,<span class="st">&quot;Population.name&quot;</span>])</span></code></pre></div>
<pre><code>## 
##                  Adygei                 Balochi            Bantu Herero 
##                      17                      21                       2 
##             Bantu Kenya      Bantu South Africa            Bantu Tswana 
##                       9                       4                       2 
##                  Basque                 Bedouin               Bedouin B 
##                      24                      43                       2 
##                 Bergamo         Bergamo Italian                   Biaka 
##                       2                       9                      21 
##            Bougainville                  Brahui                 Burusho 
##                      10                      23                      24 
##               Cambodian     Cambodian,Cambodian               Colombian 
##                       9                       1                       5 
##                     Dai                    Daur                   Druze 
##                       9                       9                      42 
##                  French                     Han                  Hazara 
##                      27                      33                      15 
##                  Hezhen                Japanese          Ju|&#39;hoan North 
##                       8                      28                       2 
##      Ju|&#39;hoan North,San                  Kalash               Karitiana 
##                       1                      22                      11 
##                    Lahu                 Makrani                Mandenka 
##                       8                      20                      21 
##                    Maya              Mayan,Maya                   Mbuti 
##                      15                       2                      11 
##             Mbuti,Mbuti                    Miao                 Mongola 
##                       2                      10                       2 
##               Mongolian                Mozabite       Mozabite,Mozabite 
##                       5                      24                       1 
##                    Naxi            Northern Han                Orcadian 
##                       8                      10                      15 
##                  Oroqen             Palestinian                  Papuan 
##                       9                      42                       3 
##            Papuan Sepik Papuan,Papuan Highlands     Papuan,Papuan Sepik 
##                       1                       6                       6 
##                  Pathan           Pathan,Pathan                 Piapoco 
##                      21                       1                       2 
##                    Pima                 Russian                     San 
##                      12                      25                       2 
##               Sardinian                     She                  Sindhi 
##                      27                      10                      22 
##                   Surui                      Tu                   Tujia 
##                       8                      10                      10 
##                  Tuscan                   Uygur                    Xibo 
##                       8                      10                       9 
##                   Yakut                      Yi                  Yoruba 
##                      21                      10                      20</code></pre>
<p>Más arriba describíamos el “problema” de la falta de equilibrio Hardy-Weinberg en los marcadores considerados, pero uno de los supuestos del equilibrio de Hardy-Weinberg es que los apareamientos sean al azar, es decir en condiciones de “panmixia”. Observando el origen de nuestras muestras resulta claro de que esto es claramente imposible de que se cumpla, ya que aún en las muestras identificadas en el <strong>IGSR</strong> tenemos 78 poblaciones diferentes y es totalmente improbable que los individuos de las mismas se apareen con la misma probabilidad con individuos de la misma población que con individuos de cualquier otra población.</p>
<p>Antes de seguir con este problema vamos a hacer una pequeña disgresión, para ver cómo el formato numérico de los genotipos me permite hacer cálculos eficientes. Veamos el problema de calcular las frecuencias de los alelos (de referencia o el alternativo) con nuestros datos seleccionados. De acuerdo con nuestro esquema de codificación numérica, el cero corresponde a ninguna copia del alelo alternativo (o lo que es lo mismo, a dos copias del de referencia), el uno se corresponde a una copia del alelo alternativo (y la otra del de referencia) y el dos se corresponde a dos copias del alelo alternativo (y ninguna del de referencia). Si tenemos <span class="math inline">\(N\)</span> individuos diploides (los humanos somos diploides, y en nuestro genotipado es la situación mayoriataria, exceptuando el genoma mitocondrial), entonces tendremos un total de <span class="math inline">\(2N\)</span> alelos. Por lo tanto, para cada marcador, la frecuencia del alelo alternativo será igual a la suma de los genotipos numéricos de todos los individuos, dividido entre <span class="math inline">\(2N\)</span>. Para calcular estas frecuencias para todos los marcadores, podemos hacer:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="genética-de-poblaciones.html#cb92-1" aria-hidden="true" tabindex="-1"></a>freqSNPS<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan,<span class="dv">1</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(x)))</span>
<span id="cb92-2"><a href="genética-de-poblaciones.html#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="genética-de-poblaciones.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(freqSNPS,<span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;Histograma de frequencia del alelo ALT&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;frecuencia del ALT&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk126-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sin embargo, la función para calcular las frecuencias como la escribimos más arriba tiene el problema de no poder resolver genotipos faltantes (NA). Una versión mejorada de la misma sería:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="genética-de-poblaciones.html#cb93-1" aria-hidden="true" tabindex="-1"></a>freqSNPS<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan,<span class="dv">1</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))))</span>
<span id="cb93-2"><a href="genética-de-poblaciones.html#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="genética-de-poblaciones.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(freqSNPS,<span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;Histograma de frequencia del alelo ALT&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;frecuencia del ALT&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk127-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>En el histograma anterior se aprecia claramente que las frecuencias van desde cero hasta 0.63, lo que nos da una idea muy clara de que <strong>REF</strong> y <strong>ALT</strong> no se refieren al alelo mayoritario o minoritario. Una forma obvia de analizar estos datos es estudiar la frecuencia del alelo menor, <strong>MAF</strong>. En nuestro caso, al existir solo dos alelos por <em>locus</em>, la suma de las frecuencias relativas debe ser igual a uno, por lo que si la frecuencia de <strong>ALT</strong> es mayor a <span class="math inline">\(\frac{1}{2}=0.5\)</span>, entonces el alelo menor será el de <strong>REF</strong> y al revés, si es menor a <span class="math inline">\(\frac{1}{2}\)</span> entonces el alelo menor ser el <strong>ALT</strong>. En términos del EBI:</p>
<hr />
<p>“When working with genome scale data the term <strong>reference allele</strong> refers to the <strong>base that is found in the reference genome</strong>. Since the reference is just somebody’s genome, it is not always the major allele. In contrast, the <strong>alternative allele</strong> refers to <strong>any base, other than the reference</strong>, that is found at that locus.”</p>
<hr />
<p>Al tratarse de una convención algo arbitraria es de esperar en cierta forma una bimodalidad de los datos, que si miramos con atención se observa en el histograma anterior. Una forma de superar esto es calcular la frecuencia del alelo menor (o del mayor). Para calcular la frecuencia del alelo menor (<strong>MAF</strong>), podemos hacer simplemente:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="genética-de-poblaciones.html#cb94-1" aria-hidden="true" tabindex="-1"></a>maf<span class="ot">&lt;-</span>freqSNPS</span>
<span id="cb94-2"><a href="genética-de-poblaciones.html#cb94-2" aria-hidden="true" tabindex="-1"></a>maf[<span class="fu">which</span>(maf<span class="sc">&gt;</span><span class="fl">0.5</span>)]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>maf[<span class="fu">which</span>(maf<span class="sc">&gt;</span><span class="fl">0.5</span>)]</span>
<span id="cb94-3"><a href="genética-de-poblaciones.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(maf,<span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;Histograma de frequencia del alelo menor&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;MAF&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk128-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Volvamos ahora al tema de las distintas poblaciones y veamos si afecta en algo las frecuencias de los alelos en las mismas. Para evitar frecuencias extremas derivadas del bajo número de individuos (por ejemplo, con dos individuos las frecuencias posibles del <strong>MAF</strong> son <span class="math inline">\(0\)</span>, <span class="math inline">\(1/4=0.25\)</span> y <span class="math inline">\(1/2=0.5\)</span>), vamos a trabajar solo con las poblaciones que tienen más de 20 individuos en nuestra base:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="genética-de-poblaciones.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tb<span class="sc">$</span>Population.name)[<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)<span class="sc">&gt;</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>## 
## African Ancestry SW             Balochi              Basque             Bedouin 
##                  34                  21                  24                  43 
##               Biaka              Brahui             Burusho                CEPH 
##                  21                  23                  24                 108 
##               Druze              French            Gujarati                 Han 
##                  42                  27                  82                  33 
##         Han Chinese            Japanese              Kalash               Luhya 
##                  83                 112                  22                  72 
##            Mandenka    Mexican Ancestry            Mozabite         Palestinian 
##                  21                  49                  24                  42 
##              Pathan             Russian           Sardinian              Sindhi 
##                  21                  25                  27                  22 
##             Toscani               Yakut              Yoruba 
##                  88                  21                 125</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="genética-de-poblaciones.html#cb97-1" aria-hidden="true" tabindex="-1"></a>popmas20<span class="ot">&lt;-</span><span class="fu">names</span>(<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)[<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)<span class="sc">&gt;</span><span class="dv">20</span>])</span>
<span id="cb97-2"><a href="genética-de-poblaciones.html#cb97-2" aria-hidden="true" tabindex="-1"></a>popmas20</span></code></pre></div>
<pre><code>##  [1] &quot;African Ancestry SW&quot; &quot;Balochi&quot;             &quot;Basque&quot;             
##  [4] &quot;Bedouin&quot;             &quot;Biaka&quot;               &quot;Brahui&quot;             
##  [7] &quot;Burusho&quot;             &quot;CEPH&quot;                &quot;Druze&quot;              
## [10] &quot;French&quot;              &quot;Gujarati&quot;            &quot;Han&quot;                
## [13] &quot;Han Chinese&quot;         &quot;Japanese&quot;            &quot;Kalash&quot;             
## [16] &quot;Luhya&quot;               &quot;Mandenka&quot;            &quot;Mexican Ancestry&quot;   
## [19] &quot;Mozabite&quot;            &quot;Palestinian&quot;         &quot;Pathan&quot;             
## [22] &quot;Russian&quot;             &quot;Sardinian&quot;           &quot;Sindhi&quot;             
## [25] &quot;Toscani&quot;             &quot;Yakut&quot;               &quot;Yoruba&quot;</code></pre>
<hr />
<p>Calculemos ahora para todas ellas las frecuencias del alelo menor para todas las poblaciones.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="genética-de-poblaciones.html#cb99-1" aria-hidden="true" tabindex="-1"></a>fMAF<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">length</span>(maf),<span class="at">ncol=</span><span class="fu">length</span>(popmas20))</span>
<span id="cb99-2"><a href="genética-de-poblaciones.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fMAF)</span></code></pre></div>
<pre><code>## [1] 72820    27</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="genética-de-poblaciones.html#cb101-1" aria-hidden="true" tabindex="-1"></a>fFreq<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">length</span>(maf),<span class="at">ncol=</span><span class="fu">length</span>(popmas20))</span>
<span id="cb101-2"><a href="genética-de-poblaciones.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(popmas20)){muestras<span class="ot">&lt;-</span>tb[tb<span class="sc">$</span>Population.name<span class="sc">==</span>popmas20[i],<span class="st">&quot;Sample.name&quot;</span>];fSNPS<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan[,muestras],<span class="dv">1</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))));fFreq[,i]<span class="ot">&lt;-</span>fSNPS;mafs<span class="ot">&lt;-</span>fSNPS;mafs[<span class="fu">which</span>(mafs<span class="sc">&gt;</span><span class="fl">0.5</span>)]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>mafs[<span class="fu">which</span>(mafs<span class="sc">&gt;</span><span class="fl">0.5</span>)];fMAF[,i]<span class="ot">&lt;-</span>mafs}</span>
<span id="cb101-3"><a href="genética-de-poblaciones.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="genética-de-poblaciones.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fFreq)<span class="ot">&lt;-</span><span class="fu">colnames</span>(fMAF)<span class="ot">&lt;-</span>popmas20</span></code></pre></div>
<p>Una verificación obvia de que el promedio ponderado de las frecuencias en las poblaciones es igual a la frecuencia promedio sobre todos los datos usados se puede calcular así:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="genética-de-poblaciones.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PESOS PONDERADOS DE LAS POBLACIONES</span></span>
<span id="cb102-2"><a href="genética-de-poblaciones.html#cb102-2" aria-hidden="true" tabindex="-1"></a>pesos<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)[<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)<span class="sc">&gt;</span><span class="dv">20</span>])</span>
<span id="cb102-3"><a href="genética-de-poblaciones.html#cb102-3" aria-hidden="true" tabindex="-1"></a>ffp<span class="ot">&lt;-</span>(fFreq<span class="sc">%*%</span>pesos)<span class="sc">/</span><span class="fu">sum</span>(pesos)</span>
<span id="cb102-4"><a href="genética-de-poblaciones.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ffp,<span class="dv">100</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk131-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="genética-de-poblaciones.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FRECUENCIA SOBRE TODOS LOS DATOS CONSIDERADOS</span></span>
<span id="cb103-2"><a href="genética-de-poblaciones.html#cb103-2" aria-hidden="true" tabindex="-1"></a>freqSNPSpopmas20<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan[,tb[tb<span class="sc">$</span>Population.name<span class="sc">%in%</span>popmas20,<span class="st">&quot;Sample.name&quot;</span>]],<span class="dv">1</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))))</span>
<span id="cb103-3"><a href="genética-de-poblaciones.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(freqSNPSpopmas20,ffp,<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">xlab=</span><span class="st">&quot;media para todas las muestras consideradas&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;promedio ponderado&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk131-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notar que para evitar usar un bucle “for” que lleva muchísimo tiempo, para la verificación usamos el producto matricial, mediante el operador “%*%“, lo que acelera muchísimo los resultados. Verificado esto (ver la línea de regresión perfecta sobre la diagonal), podemos estudiar un poco la variabilidad de las frecuencias en las distintas poblaciones respecto a la frecuencia media en los datos.</p>
<p>Por ejemplo, la población con más individuos en nuestra muestra es la Yoruba con 125 individuos. Veamos la variación de la frecuencia del alternativo en esta población respecto a dicha frecuencia en el promedio.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="genética-de-poblaciones.html#cb104-1" aria-hidden="true" tabindex="-1"></a>popNmax<span class="ot">&lt;-</span><span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)[<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)<span class="sc">&gt;</span><span class="dv">20</span>],<span class="cn">TRUE</span>)[<span class="dv">1</span>])</span>
<span id="cb104-2"><a href="genética-de-poblaciones.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(freqSNPSpopmas20,fFreq[,popNmax],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk132-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Veamos ahora lo que ocurre para una de las poblaciones con número mínimo de genomas en nuestros datos:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="genética-de-poblaciones.html#cb105-1" aria-hidden="true" tabindex="-1"></a>popNmin<span class="ot">&lt;-</span><span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)[<span class="fu">table</span>(tb<span class="sc">$</span>Population.name)<span class="sc">&gt;</span><span class="dv">20</span>],<span class="cn">FALSE</span>)[<span class="dv">1</span>])</span>
<span id="cb105-2"><a href="genética-de-poblaciones.html#cb105-2" aria-hidden="true" tabindex="-1"></a>popNmin</span></code></pre></div>
<pre><code>## [1] &quot;Balochi&quot;</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="genética-de-poblaciones.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(freqSNPSpopmas20,fFreq[,popNmin],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk133-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Claramente, en ambos casos se observa una enorme dispersión de los datos respecto al promedio, lo que nos indica claramente que las frecuencias promedio calculadas sobre poblaciones muy distintas, usándolas en conjunto, son un muy mal estimador de lo que podemos esperar del resto de los parámetros genéticos de interés. En la medida de que las poblaciones consideradas son más cercanas, desde el punto de vista genético, las frecuencias de los distintos alelos se distribuyen de una forma ajusta sobre la recta de regresión entre ellas. Por ejemplo, para las poblaciones de franceses y toscanos, podemos observar lo siguiente:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="genética-de-poblaciones.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fFreq[,<span class="st">&quot;French&quot;</span>],fFreq[,<span class="st">&quot;Toscani&quot;</span>],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;darkgreen&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;French&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Toscani&quot;</span>,<span class="at">main=</span><span class="st">&quot;Frecuencias alelos ALT&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk134-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>De hecho, si utilizamos la matriz de frecuencias de los alelos alternativos para las distintas poblaciones, podemos tener una primera aproximación a la relación genética entre poblaciones haciendo un “dendrograma” de cómo se agrupan de acuerdo a las distancias entre frecuencias alélicas.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="genética-de-poblaciones.html#cb109-1" aria-hidden="true" tabindex="-1"></a>midist<span class="ot">&lt;-</span><span class="fu">dist</span>(<span class="fu">t</span>(fFreq))</span>
<span id="cb109-2"><a href="genética-de-poblaciones.html#cb109-2" aria-hidden="true" tabindex="-1"></a>miclus<span class="ot">&lt;-</span><span class="fu">hclust</span>(midist)</span>
<span id="cb109-3"><a href="genética-de-poblaciones.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(miclus,<span class="at">sub=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;distancia entre frecuencias&quot;</span>,<span class="at">main=</span><span class="st">&quot;Poblaciones&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk135-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Podemos utilizar este agrupamiento anterior para ver que ocurre entre dos poblaciones que aparecen como muy cercanas, como la CEPH (centro-europeos) y la toscana,</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="genética-de-poblaciones.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fFreq[,<span class="st">&quot;CEPH&quot;</span>],fFreq[,<span class="st">&quot;Toscani&quot;</span>],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;green4&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;CEPH&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Toscani&quot;</span>,<span class="at">main=</span><span class="st">&quot;Frecuencias alelos ALT&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk136-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>las poblaciones Han y Han Chinese,</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="genética-de-poblaciones.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fFreq[,<span class="st">&quot;Han&quot;</span>],fFreq[,<span class="st">&quot;Han Chinese&quot;</span>],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;yellow4&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Han&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Han Chinese&quot;</span>,<span class="at">main=</span><span class="st">&quot;Frecuencias alelos ALT&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk137-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>o como la <strong>Luhya</strong> y la <strong>Yoruba</strong>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="genética-de-poblaciones.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fFreq[,<span class="st">&quot;Yoruba&quot;</span>],fFreq[,<span class="st">&quot;Luhya&quot;</span>],<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">col=</span><span class="st">&quot;blue2&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Yoruba&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Luhya&quot;</span>,<span class="at">main=</span><span class="st">&quot;Frecuencias alelos ALT&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk138-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>De hecho, estos últimos dos pueblos son originarios del África. Mientras los Yorubas habitan los actuales territorios de Nigeria, Benin y Togo (en el occidente de África), los Luhya, que comprenden un número importante de grupos étnicos “Bantú”, habitan principalmente en la provincia occidental de Kenia, país que se encuentra del otro lado del continente.</p>
<p>Antes, habíamos encontrado que los marcadores no estaban en equilibrio de Hardy-Weinberg cuando considerábamos el global de la población y explicamos la posible razón.</p>
<p><strong>Analizar si los marcadores en la población Yoruba se encuentran en equilibrio de Hardy-Weinberg</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="genética-de-poblaciones.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### YORUBA ####</span></span>
<span id="cb113-2"><a href="genética-de-poblaciones.html#cb113-2" aria-hidden="true" tabindex="-1"></a>genot.Yoruba<span class="ot">&lt;-</span>genot[,<span class="fu">which</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">colnames</span>(genot),<span class="cf">function</span>(x)<span class="fu">strsplit</span>(x,<span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]))<span class="sc">%in%</span>tb[tb<span class="sc">$</span>Population.name<span class="sc">==</span><span class="st">&quot;Yoruba&quot;</span>,<span class="st">&quot;Sample.name&quot;</span>])]</span>
<span id="cb113-3"><a href="genética-de-poblaciones.html#cb113-3" aria-hidden="true" tabindex="-1"></a>mita.Yoruba<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(genot.Yoruba,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">table</span>(x)[<span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>)]))</span>
<span id="cb113-4"><a href="genética-de-poblaciones.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mita.Yoruba)<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;geno&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb113-5"><a href="genética-de-poblaciones.html#cb113-5" aria-hidden="true" tabindex="-1"></a>mita.Yoruba[<span class="fu">is.na</span>(mita.Yoruba)]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb113-6"><a href="genética-de-poblaciones.html#cb113-6" aria-hidden="true" tabindex="-1"></a>mita.Yoruba.rel<span class="ot">&lt;-</span>mita.Yoruba<span class="sc">/</span><span class="fu">apply</span>(mita.Yoruba,<span class="dv">1</span>,sum)</span>
<span id="cb113-7"><a href="genética-de-poblaciones.html#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="genética-de-poblaciones.html#cb113-8" aria-hidden="true" tabindex="-1"></a>HWmarcadores.Yoruba<span class="ot">&lt;-</span><span class="fu">apply</span>(mita.Yoruba,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">chisq.test</span>(<span class="fu">eqHWtabla</span>(x))<span class="sc">$</span>p.value)</span>
<span id="cb113-9"><a href="genética-de-poblaciones.html#cb113-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-10"><a href="genética-de-poblaciones.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(HWmarcadores.Yoruba,<span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;HW en marcadores YORUBA&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;p-values&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk139-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="genética-de-poblaciones.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HWmarcadores.Yoruba<span class="sc">&lt;</span><span class="fl">1e-2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="fu">length</span>(HWmarcadores.Yoruba)</span></code></pre></div>
<pre><code>## [1] 2.746498e-05</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="genética-de-poblaciones.html#cb116-1" aria-hidden="true" tabindex="-1"></a>pval.bonferroni.Yoruba<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(HWmarcadores.Yoruba, <span class="at">method =</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb116-2"><a href="genética-de-poblaciones.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pval.bonferroni.Yoruba<span class="sc">&lt;</span><span class="fl">1e-2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="fu">length</span>(pval.bonferroni.Yoruba)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Claramente, el número de marcadores (y la proporción) que no se encuentran en equilibrio HW es muy reducido, por lo que podemos inferir que, en principio, en esta población se estarían cumpliendo los supuestos del mismo.</p>
<p><br />
</p>
<div id="ejercicio-1.1" class="section level4 unnumbered hasAnchor">
<h4>Ejercicio 1.1<a href="genética-de-poblaciones.html#ejercicio-1.1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Demostrar (a) que para un locus con dos alelos en una especie diploide
en equilibrio Hardy-Weinberg, la diferencia de frecuencias alélicas es
igual a la diferencia de frecuencia entre los homocigotos respectivos y
(b) que esta diferencia es igual a <span class="math inline">\(2p -1\)</span>.</p>
<p><strong><em>Solución</em></strong>
Supongamos que llamamos <span class="math inline">\(p\)</span> y <span class="math inline">\(q=1-p\)</span> a las frecuencias de los dos
alelos. Para la parte (a) debemos demostrar que su diferencia es igual a
la diferencia entre los genotipos homocigotos, es decir, <span class="math inline">\(p-q=p^2-q^2\)</span>.
Para ellos utilizaremos el hecho de que multiplicar por 1 ambos lados de
la ecuación y el hecho de que <span class="math inline">\(p+q=1\)</span>. <span class="math display">\[\begin{aligned}
(p-q)=1*(p-q)=(p+q)(p-q)=p^2+pq-pq-q^2=p^2-q^2\end{aligned}\]</span> En tanto,
para la parte (b) utilizaremos que <span class="math inline">\(q=1-p\)</span>, por lo que <span class="math display">\[\begin{aligned}
p-q=p-(1-p)=p-1+p=2p-1\end{aligned}\]</span></p>
</div>
</div>
<div id="análisis-de-componentes-principales" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Análisis de Componentes Principales<a href="genética-de-poblaciones.html#análisis-de-componentes-principales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El análisis de tablas de datos como las que nos ocupan es un tema generalmente difícil dado el alto número de dimensiones del problema. Es decir, si para el mismo número total de celdas tuviésemos solamente dos columnas (es decir dos variables), se nos ocurre fácilmente que una forma de representar los datos es graficar una variable contra la otra. Sin embargo, cuando tenemos decenas, centenas o aún miles de variables como en nuestro caso, la representación gráfica de los datos es bastante más compleja. De hecho, está comprobado que la mayor parte de los humanos difícilmente consigue visualizar representaciones en más de 3 dimensiones. ¿Cómo hacemos entonces para explotar el poder de la visualización con datos multidimensionales?</p>
<p>Una forma interesante es la que entiende que los datos se pueden considerar como una nube de puntos en un espacio n-dimensional y que por lo tanto podemos re-ordenar los ejes coordinados de este espacio, de tal forma que el primer eje se corresponda con la dirección que captura mayor variación en los datos, el segundo eje, ortogonal al primero, en la dirección que coincida con la mayor variablidad restante, el tercero (ortogonal a los dos primeros) en la dirección que coincida con la mayor variabilidad restante y así sucesivamente. Basicamente, esta es la idea del ANÁLISIS de COMPONENTES PRINCIPALES (PCA).</p>
<p>Existen diferentes modos y herramientas para realizar una PCA en R, pero vamos a ver primero qsi podemos aplicar el método general. Para eso, primero debemos solucionar el problema de los datos faltantes (genotipos sin determinar), ya que la PCA no trabaja usualmente con datos faltantes.</p>
<div id="pca-sin-na-y-con-reducido-número-de-marcadores" class="section level3 hasAnchor" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> PCA sin NA y con reducido número de marcadores<a href="genética-de-poblaciones.html#pca-sin-na-y-con-reducido-número-de-marcadores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una primera aproximación consiste en eliminar aquellas filas o columnas que contengan datos faltantes, siempre que esto no reduzca en forma significativa el conjuntos de los datos. Veamos que ocurre en nuestro caso, es decir, analicemos si tenemos muchos datos faltantes y sobre todo, cómo se distribuyen.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="genética-de-poblaciones.html#cb118-1" aria-hidden="true" tabindex="-1"></a>naSNPS<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb118-2"><a href="genética-de-poblaciones.html#cb118-2" aria-hidden="true" tabindex="-1"></a>nageno<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb118-3"><a href="genética-de-poblaciones.html#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="genética-de-poblaciones.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(naSNPS,<span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>## rs11810467  rs1450952 rs11634779 rs10467005 rs17148511  rs2801943  rs2303324 
##         54         52         52         51         46         41         39 
##  rs2267670  rs2073725  rs7772351 
##         39         38         37</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="genética-de-poblaciones.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(nageno,<span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>## 1877_NA18520 1069_PT-912H 1082_PT-91CS 1140_PT-GLG1 1139_PT-GLFL 1429_NA17967 
##         3739         3096         2977         2970         2956         2697 
## 1062_PT-8ZVZ 1220_NA12843 1888_NA19248 1422_NA18146 
##         2610         2524         2503         2388</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="genética-de-poblaciones.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(naSNPS,<span class="dv">50</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk200-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="genética-de-poblaciones.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(nageno,<span class="dv">100</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk200-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Es decir, tenemos algunos individuos con muchos datos faltantes (más de 2000) y tenemos varios marcadores que no tiene datos para muchos individuos. Una alternativa es ver la posibilidad de eliminar todos aquellos marcadores que tienen algún datos faltante (al menos uno). Veamos cuántos marcadores pasarían este flitro:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="genética-de-poblaciones.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(naSNPS<span class="sc">==</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 16133</code></pre>
<p>Si bien es una reducción sustantiva, 16133 marcadores no son tan pocos y vale la pena tener una idea primaria de que ocurre si hacemos una PCA sobre este juego inicial de marcadores. Si bien no es la forma “correcta” de escalar los datos, en esta primera aproximación vamos a explorar que ocurre con la PCA cuando la hacemos en “correlación” (ver el parámetro <strong>cor=TRUE</strong> en la función), es decir, cuando escalamos las columnas de tal forma que todas tengan la misma variación.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="genética-de-poblaciones.html#cb126-1" aria-hidden="true" tabindex="-1"></a>ngenot.sinna<span class="ot">&lt;-</span>ngenot[<span class="fu">which</span>(naSNPS<span class="sc">==</span><span class="dv">0</span>),]</span>
<span id="cb126-2"><a href="genética-de-poblaciones.html#cb126-2" aria-hidden="true" tabindex="-1"></a>mipca<span class="ot">&lt;-</span><span class="fu">princomp</span>(ngenot.sinna[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(ngenot.sinna)[<span class="dv">1</span>]),<span class="dv">3000</span>),],<span class="at">cor=</span><span class="cn">TRUE</span>)</span>
<span id="cb126-3"><a href="genética-de-poblaciones.html#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="genética-de-poblaciones.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mipca)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk202-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="genética-de-poblaciones.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(mipca,<span class="at">cex=</span><span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk202-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Si analizamos el primer gráfico, el de barras, vemos que hay 4 componentes de importancia, es decir que habría 4 dimensiones de los datos con información relvante, mientras que el resto sería variación relativamente “residual” (de menor orden, que no aporta demasiado a la interpretación del fenómeno global). Por otra parte, el segundo gráfico intenta representar en la misma visualización los marcadores y los individuos, lo que dado el importante número de ambos resulta en un gráfico imposible de interpretar. Si bien es posible ajustar los parámetros para mejorar sustancialmente la visualización, veremos más adelante que algunos paquetes resuleven este problema de manera muy satisfactoria y mayormente sin nuestra intervención.</p>
<p>Finalmente, para saber si los marcadores que elegimos (aquellos sin datos faltantes) son una muestra representativa y sin sesgo del conjunto de todos los marcadores, al menos respecto al cromosoma de origen, podemos ver que ocurre en los dos conjuntos de datos y ver si la diferencia es significativa.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="genética-de-poblaciones.html#cb128-1" aria-hidden="true" tabindex="-1"></a>(tsna<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="st">&quot;todos&quot;</span><span class="ot">=</span><span class="fu">table</span>(snps[,<span class="st">&quot;CHROM&quot;</span>]),<span class="st">&quot;sin.na&quot;</span><span class="ot">=</span><span class="fu">table</span>(snps[<span class="fu">which</span>(naSNPS<span class="sc">==</span><span class="dv">0</span>),<span class="st">&quot;CHROM&quot;</span>])))</span></code></pre></div>
<pre><code>##    todos sin.na
## 1   5793   1451
## 10  3964    976
## 11  3649    697
## 12  3531    730
## 13  2745    592
## 14  2477    434
## 15  2281    545
## 16  2183    560
## 17  1968    450
## 18  2205    539
## 19  1212    219
## 2   6066   1356
## 20  1977    508
## 21  1093    238
## 22  1075    209
## 3   5108   1127
## 4   4288    997
## 5   4610   1125
## 6   5005    975
## 7   4052    919
## 8   4043    980
## 9   3495    506</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="genética-de-poblaciones.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(tsna,<span class="dv">2</span>,sum)</span></code></pre></div>
<pre><code>##  todos sin.na 
##  72820  16133</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="genética-de-poblaciones.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tsna)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tsna
## X-squared = 211.13, df = 21, p-value &lt; 2.2e-16</code></pre>
<p>Claramente, el valor del test de <span class="math inline">\(\chi^2\)</span> es altamente significativo, lo que significa que ambos juegos de marcadores difieren en la proporción que representa a cada cromosoma.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="genética-de-poblaciones.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">t</span>(tsna)<span class="sc">/</span><span class="fu">apply</span>(tsna,<span class="dv">2</span>,sum))</span></code></pre></div>
<pre><code>##         todos     sin.na
## 1  0.07955232 0.08993987
## 10 0.05443559 0.06049712
## 11 0.05010986 0.04320337
## 12 0.04848943 0.04524887
## 13 0.03769569 0.03669497
## 14 0.03401538 0.02690138
## 15 0.03132381 0.03378169
## 16 0.02997803 0.03471146
## 17 0.02702554 0.02789314
## 18 0.03028014 0.03340978
## 19 0.01664378 0.01357466
## 2  0.08330129 0.08405132
## 20 0.02714913 0.03148825
## 21 0.01500961 0.01475237
## 22 0.01476243 0.01295481
## 3  0.07014556 0.06985682
## 4  0.05888492 0.06179880
## 5  0.06330678 0.06973285
## 6  0.06873112 0.06043513
## 7  0.05564405 0.05696399
## 8  0.05552046 0.06074506
## 9  0.04799506 0.03136428</code></pre>
</div>
</div>
<div id="paquetes-específicos-para-genética-de-poblaciones-adegenet-y-hierfstat" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Paquetes específicos para genética de poblaciones (adegenet y hierfstat)<a href="genética-de-poblaciones.html#paquetes-específicos-para-genética-de-poblaciones-adegenet-y-hierfstat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta acá hemos trabajado esencialmente con los distintos componentes básicos de información que existen en un archivo VCF en forma separada. El motivo de esto fue el de explorar y entender dichos componentes a cabalidad, así como entender que nosotros podemos especificar fácilmente las operaciones sobre los datos que sean de nuestro interés. Sin embargo, existen diferentes paquetes en <strong>R</strong> que nos permiten trabajar con datos de genética de poblaciones. Uno de estos paquetes es <strong>adegenet</strong>. Si no lo tienes instalado, es fácil hacerlo con <em>install.packages(“adegenet”, dep=TRUE)</em>. Lo primero que vamos a hacer entonces es crear un objeto de la clase “genind”, una clase central para este paquete y de la que podremos utilizar diversas funciones directamente. Es importante notar que la función <em>df2genind()</em>, encargada de crear el objeto de clase “genind” a partir de la tabla de genotipos (y de otra información, por ejemplo la tabla de poblaciones), utiliza el formato del tipo “0/0”, “0/1”, “1/1” de nuestros datos, por lo que si queremos trabajar con los datos que están en la tabla del <strong>IGSR</strong> debemos subsetear ahora la tabla de genotipos en dicho formato.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="genética-de-poblaciones.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;adegenet&quot;, dep=TRUE)</span></span>
<span id="cb136-2"><a href="genética-de-poblaciones.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;adegenet&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## 
##    /// adegenet 2.1.10 is loaded ////////////
## 
##    &gt; overview: &#39;?adegenet&#39;
##    &gt; tutorials/doc/questions: &#39;adegenetWeb()&#39; 
##    &gt; bug reports/feature requests: adegenetIssues()</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="genética-de-poblaciones.html#cb139-1" aria-hidden="true" tabindex="-1"></a>genot.estan<span class="ot">&lt;-</span>genot[,muestras.que.estan]</span>
<span id="cb139-2"><a href="genética-de-poblaciones.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(genot.estan)<span class="ot">&lt;-</span>nombresengenot[<span class="fu">which</span>(nombresengenot<span class="sc">%in%</span>ta<span class="sc">$</span>Sample.name)]</span>
<span id="cb139-3"><a href="genética-de-poblaciones.html#cb139-3" aria-hidden="true" tabindex="-1"></a>genpop<span class="ot">&lt;-</span><span class="fu">df2genind</span>(<span class="fu">t</span>(genot.estan[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(genot)[<span class="dv">1</span>],<span class="dv">3000</span>),]),<span class="at">sep=</span><span class="st">&quot;/&quot;</span>,<span class="at">pop=</span>tb<span class="sc">$</span>Population.name)</span>
<span id="cb139-4"><a href="genética-de-poblaciones.html#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="genética-de-poblaciones.html#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(genpop)</span></code></pre></div>
<pre><code>## [1] &quot;genind&quot;
## attr(,&quot;package&quot;)
## [1] &quot;adegenet&quot;</code></pre>
<p>Para ver los distintos “slots” que tenemos en este objeto, podemos hacer simplemente:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="genética-de-poblaciones.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># los slots que existen en este objeto</span></span>
<span id="cb141-2"><a href="genética-de-poblaciones.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(genpop)</span></code></pre></div>
<pre><code>##  [1] &quot;tab&quot;       &quot;loc.fac&quot;   &quot;loc.n.all&quot; &quot;all.names&quot; &quot;ploidy&quot;    &quot;type&quot;     
##  [7] &quot;other&quot;     &quot;call&quot;      &quot;pop&quot;       &quot;strata&quot;    &quot;hierarchy&quot;</code></pre>
<p>Una forma sencilla que ya probamos para extraer información de los “slots” es acceder a ellos directamente a través del operador “arroba”, pero mejor aún, existen funciones específicas (más seguras) para acceder a los correspondientes “slots”:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="genética-de-poblaciones.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># un trozo de la tabla de genotipos</span></span>
<span id="cb143-2"><a href="genética-de-poblaciones.html#cb143-2" aria-hidden="true" tabindex="-1"></a>genpop<span class="sc">@</span>tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##           rs2899887.0 rs2899887.1 rs958877.0 rs958877.1 rs6455553.1 rs6455553.0
## HGDP00479           2           0          2          0           2           0
## HGDP00985           2           0          2          0           0           2
## HGDP01094           2           0          2          0           1           1
## HGDP00982           2           0          2          0           1           1
## HGDP00911           2           0          2          0           2           0
## HGDP01202           2           0          2          0           2           0
## HGDP00461           2           0          2          0           2           0
## HGDP00986           2           0          2          0           2           0
## HGDP00449           2           0          2          0           2           0
## HGDP00912           2           0          2          0           2           0
##           rs12931133.0 rs12931133.1 rs2041794.0 rs2041794.1
## HGDP00479            2            0           1           1
## HGDP00985            2            0           2           0
## HGDP01094            2            0           2           0
## HGDP00982            2            0           0           2
## HGDP00911            2            0           1           1
## HGDP01202            2            0           1           1
## HGDP00461            2            0           2           0
## HGDP00986            2            0           1           1
## HGDP00449            2            0           1           1
## HGDP00912            2            0           2           0</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="genética-de-poblaciones.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejor aún, podemos extraerlo con una función específica</span></span>
<span id="cb145-2"><a href="genética-de-poblaciones.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab</span>(genpop)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##           rs2899887.0 rs2899887.1 rs958877.0 rs958877.1 rs6455553.1 rs6455553.0
## HGDP00479           2           0          2          0           2           0
## HGDP00985           2           0          2          0           0           2
## HGDP01094           2           0          2          0           1           1
## HGDP00982           2           0          2          0           1           1
## HGDP00911           2           0          2          0           2           0
## HGDP01202           2           0          2          0           2           0
## HGDP00461           2           0          2          0           2           0
## HGDP00986           2           0          2          0           2           0
## HGDP00449           2           0          2          0           2           0
## HGDP00912           2           0          2          0           2           0
##           rs12931133.0 rs12931133.1 rs2041794.0 rs2041794.1
## HGDP00479            2            0           1           1
## HGDP00985            2            0           2           0
## HGDP01094            2            0           2           0
## HGDP00982            2            0           0           2
## HGDP00911            2            0           1           1
## HGDP01202            2            0           1           1
## HGDP00461            2            0           2           0
## HGDP00986            2            0           1           1
## HGDP00449            2            0           1           1
## HGDP00912            2            0           2           0</code></pre>
<p>Como mencionamos más arriba, es importante notar que la transformación de nuestros datos que estaban en formato “0/0”, “0/1”, “1/1” se pasaron al formato numérico que usamos antes. La conversión fue automática y como también dijimos previamente, esto permite trabajar cómodamente con funciones matemáticas en lugar de con funciones sobre texto.</p>
<p>La función <em>pop()</em> extrae las poblaciones a las que corresponden las muestras de este objeto. Con este dato, por ejemplo, podemos graficar el tamaño de muestra para las distintas poblaciones haciendo:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="genética-de-poblaciones.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(<span class="fu">pop</span>(genpop)), <span class="at">col=</span><span class="fu">funky</span>(<span class="dv">17</span>), <span class="at">las=</span><span class="dv">3</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Tamaño de muestra&quot;</span>,<span class="at">cex.names=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk303-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Un paso importante es resumir la información existente en nuestra muestra, cosa que podemos hacer usando la función <em>summary()</em> y ya de paso verificar la proporción de datos (genotipos) faltantes:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="genética-de-poblaciones.html#cb148-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">summary</span>(genpop)</span>
<span id="cb148-2"><a href="genética-de-poblaciones.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)</span></code></pre></div>
<pre><code>## [1] &quot;n&quot;         &quot;n.by.pop&quot;  &quot;loc.n.all&quot; &quot;pop.n.all&quot; &quot;NA.perc&quot;   &quot;Hobs&quot;     
## [7] &quot;Hexp&quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="genética-de-poblaciones.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PORCENTAJE DE DATOS FALTANTES</span></span>
<span id="cb150-2"><a href="genética-de-poblaciones.html#cb150-2" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>NA.perc</span></code></pre></div>
<pre><code>## [1] 0.09409177</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="genética-de-poblaciones.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VERIFICACIÓN</span></span>
<span id="cb152-2"><a href="genética-de-poblaciones.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(genpop<span class="sc">@</span>tab))<span class="sc">/</span>(<span class="fu">dim</span>(genpop<span class="sc">@</span>tab)[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">dim</span>(genpop<span class="sc">@</span>tab)[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.0009409177</code></pre>
<p>Por otra parte, a partir de este resumen también podemos estudiar el comportamiento de la heterocigosidad observada respecto a la esperada para todos los marcadores, buscando aquellos marcadores que más se apartan de lo esperado.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="genética-de-poblaciones.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temp<span class="sc">$</span>Hexp, temp<span class="sc">$</span>Hobs, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">55</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">55</span>),<span class="at">xlab=</span><span class="st">&quot;Hexp&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Hobs&quot;</span>)</span>
<span id="cb154-2"><a href="genética-de-poblaciones.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk305-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>¿Cómo es el comportamiento de la heterocigosidad observada respecto a la esperada?</strong> <strong>¿Es en general mayor la observada o la esperada?</strong> <strong>¿A qué se puede deber esto?</strong></p>
<hr />
<hr />
</div>
<div id="el-coeficiente-de-endocría-y-estadísticos-f-introducción-teórica" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> El Coeficiente de endocría y estadísticos <em>F</em> (introducción teórica)<a href="genética-de-poblaciones.html#el-coeficiente-de-endocría-y-estadísticos-f-introducción-teórica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como ya vimos previamente, las poblaciones de muchas especies se encuentran estructuradas en sub-poblaciones, cada una de ellas con su propia dinámica evolutiva. Por ejemplo, dentro de una región tenemos diferentes cuencas, que a su vez tienen diversos afluentes, que cada una de ellos posee una conexión con diferentes espejos de agua. Eso nos permite identificar, en forma arbitraria al principio, diferentes niveles dentro de una jerarquía: cuencas, dentro de ellas afluentes y dentro de los mismos los espejos de agua. La estructura puede ser también mucho más sencilla, con un par de niveles, por ejemplo poblaciones aisladas (por una barrera física, por ejemplo) dentro de un conjunto regional de las mismas (<strong>ensemble</strong>). En este sentido, en lo que nos atañe en este momento, la estructura reproductiva de cada población del <strong>ensemble</strong> puede seguir sus propios patrones, lo que se reflejará también en la relación entre frecuencias alélicas y genotípicas de cada una de ellas. Como vimos antes, el apartamiento del apareamiento al azar se refleja usualmente en una carencia de heterocigotos respecto a lo esperado para el equilibrio de Hardy-Weinberg. Es más, definimos un índice de fijación <span class="math inline">\(F\)</span> como la probabilidad de encontrar en un <em>locus</em> dos alelos idénticos por ascendencia y vimos que la pérdida de heterocigotos era igual a <span class="math inline">\(2pqF\)</span>. Sin embargo, al tener distintas poblaciones (y por lo tanto niveles, por ejemplo individuos, poblaciones, <strong>ensemble</strong>) necesitamos de alguna forma entender a qué nivel se producen los apartamientos respecto al equilibrio Hardy-Weinberg. Para esto definiremos una serie de estadísticos, primero para representar la heterocigosidad observada y esperada a distintos niveles y luego unos estadísticos de fijación análogos a nuestro <span class="math inline">\(F\)</span>.</p>
<p>En la figura <a href="genética-de-poblaciones.html#fig:Festad">1.2</a> se observa una representación de una estructura poblacional, de una especie diploide, donde diferentes poblaciones (enmarcadas por recuadros verdes) poseen una diferente proporción de alelos de dos colores, rojo y azul, así como distintas proporciones de los 3 genotipos. Todas estas poblaciones se encuentran agregadas en un gran <strong>ensemble</strong>, encuadrado en azul.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Festad"></span>
<img src="figuras/Festadisticos2.png" alt="Estructuración de una gran población (marco en azul) como un ensemble de poblaciones (marcos en verde) y las distribución de la heterocigosidad observada y esperada a los distintos niveles de agregación, así como los correspondientes estadísticos." width="80%" />
<p class="caption">
Figura 1.2: Estructuración de una gran población (marco en azul) como un <strong>ensemble</strong> de poblaciones (marcos en verde) y las distribución de la heterocigosidad observada y esperada a los distintos niveles de agregación, así como los correspondientes estadísticos.
</p>
</div>
<p><br />
</p>
<p>Claramente, dentro de cada población es posible contar la proporción de individuos heterocigotas (si estos fuesen distinguibles por su fenotipo, o si lo podemos hacer a nivel molecular) y por lo tanto, si tenemos <span class="math inline">\(n\)</span> poblaciones, para cada una de ellas obtendremos un estimador <span class="math inline">\(\hat{H}_i\)</span>. Decimos que obtenemos un estimador, y por eso lo señalamos con el “gorro” (<span class="math inline">\(\hat{}\)</span>) porque normalmente solo tenemos una muestra de individuos de cada población. Una manera sencilla de resumir la información respecto a la proporción de heterocigotas de cada una de ellas será la media de la heterocigosidad, es decir</p>
<p><span class="math display" id="eq:HI">\[\begin{equation}
H_I=\frac{1}{n}\sum_{i=1}^n\hat{H}_i
\tag{1.2}
\end{equation}\]</span></p>
<p>Se trata, en este caso de una forma de resumir la información sobre la <strong>heterocigosidad observada</strong>, producto de los <span class="math inline">\(F\)</span> a nivel individual y por eso el subíndice <span class="math inline">\(I\)</span>. Para cuantificar la reducción respecto a lo esperado con dicha estructura, en primer lugar debemos calcular una medida resumen de <strong>lo esperado</strong> en cada población si las mismas se aparearan (a la interna) al azar. Otra vez, una medida sencilla lo constituye la media de lo esperado en cada una. Por lo tanto,</p>
<p><span class="math display" id="eq:HS">\[\begin{equation}
H_S=\frac{1}{n}\sum_{i=1}^n2p_iq_i
\tag{1.3}
\end{equation}\]</span></p>
<p>ya que en cada una de las <span class="math inline">\(n\)</span> poblaciones las frecuencias alélicas pueden ser diferentes y por eso el <span class="math inline">\(p_i\)</span> y <span class="math inline">\(q_i=1-p_i\)</span>. En este punto solo nos queda definir un nivel de heterocigosidad. Si ponemos todos los individuos juntos, sin importar de que población vengan, entonces la <strong>heterocigosidad esperada global</strong> es igual a</p>
<p><span class="math display" id="eq:HT">\[\begin{equation}
H_T=2\bar{p}\bar{q}
\tag{1.4}
\end{equation}\]</span></p>
<p>Con todos estos estimadores de heterocigosidad en mano estamos ahora en condiciones de entender la estructura de la pérdida de heterocigosisidad, es decir, a qué nivel y cuánto se da la pérdida. El primer nivel, dentro de la estructura representada en la figura <a href="genética-de-poblaciones.html#fig:Festad">1.2</a> es el que corresponde a la pérdida entre lo esperado y lo observado dentro de las poblaciones. Como nuestras medidas de heterocigosis esperada y observada son <span class="math inline">\(H_S\)</span> y <span class="math inline">\(H_I\)</span> respectivamente, la diferencia entre ellos, estandarizada por la esperada será nuestro índice de fijación a nivel intra población, es decir</p>
<p><span class="math display" id="eq:FIS">\[\begin{equation}
F_{IS}=\frac{H_S-{H}_I}{H_S}
\tag{1.5}
\end{equation}\]</span></p>
<p>En este caso, las letras que aparecen en el súbíndice representan lo individual o intra-población (<span class="math inline">\(I\)</span>) versus lo esperado para la población (<span class="math inline">\(S\)</span> de sub-población). Más aún, <span class="math inline">\(F_{IS}\)</span> es exactamente igual al <span class="math inline">\(F\)</span> definido previamente, en la medida de que la media represente adecuadamente lo que ocurre dentro de cada población.</p>
<p>En nuestra estructura, el siguiente nivel sería comparar lo esperado en la población total con lo esperado si se cumpliese el equilibrio de Hardy-Weinberg en cada una de las poblaciones. Una nota importante es que aún cumpliéndose el equilibrio de Hardy-Weinberg en cada población no necesariamente se cumple cuando consideramos a todos los individuos en conjunto. Un ejemplo claro de esto podemos verlo en la figura <a href="genética-de-poblaciones.html#fig:Separa">1.3</a>. Dos poblaciones de ovejas en lados opuestos de un río han fijado diferentes alelos para el color: a la izquierda blanco, a la derecha verde. Dentro de cada población las ovejas se aparean libremente, por lo que podemos esperar el equilibrio Hardy-Weinberg. El río es una barrera infranqueable para las ovejas, por lo que no hay migración entre ambas poblaciones. Si, mientras recorremos el río en bote, capturamos a las ovejas que pastan en la ribera (el mismo número en una ribera que en la otra), les extraemos una muestra y luego secuenciamos el <em>locus</em> “del color” (en principio no existe dicha cosa, la herencia del color en mamíferos es extremadamente compleja) vamos a llegar a unos números que nos llamarán la atención. Mientras que las frecuencias del alelo blanco y del verde son iguales, es decir <span class="math inline">\(p=q\)</span>, por lo que esperamos <span class="math inline">\(2pq=2 \frac{1}{2}\frac{1}{2}=\frac{1}{2}\)</span> heterocigotos. Sin embargo, en nuestra muestra no hay ningún individuo heterocigoto ya que las ovejas son de dos poblaciones en las que se ha fijado el alelo para el color, por lo que al considerar todo el <strong>ensemble</strong> (a través de una muestra de ambas poblaciones) nos encontramos con un déficit enorme de heterocigotos. La razón es obvia: se trata de una forma de estructura de apareamiento no-completamente-al-azar (ya que los individuos solo se pueden aparear con los de su población) y por lo tanto existirá una carencia de heterocigotos, como ya vimos en la sección [Generalización de Hardy-Weinberg para apareamientos no-aleatorios]. Más allá de ser obvia la razón, lo veremos en más detalle en la seccción referida al [El efecto Wahlund].</p>
<p><br />
</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Separa"></span>
<img src="figuras/separadas.png" alt="Reducción en el número de heterocigotos a causa de la estructuración en poblaciones disjuntas. Las ovejas a ambos lados del río, una barrera infranqueable para las mismas, han fijado alelos diferentes para el color de la lana. Si muestreamos las ovejas que aparecen en la ribera, aproximadamente igual número a ambos lados, obtendremos una frecuencia intermedia para los alelos blanco y verde, por lo que esperamos cerca del \(50\%\) de heterocigotos (\(2pq=2 \frac{1}{2}\frac{1}{2}=\frac{1}{2}\)), pero en realidad no hay ningún individuo heterocigoto ya que los alelos están fijados en las dos poblaciones (diseño de las ovejas de http://cliparts.co/clipart/2377087 Fuente: Cliparts.co)." width="80%" />
<p class="caption">
Figura 1.3: Reducción en el número de heterocigotos a causa de la estructuración en poblaciones disjuntas. Las ovejas a ambos lados del río, una barrera infranqueable para las mismas, han fijado alelos diferentes para el color de la lana. Si muestreamos las ovejas que aparecen en la ribera, aproximadamente igual número a ambos lados, obtendremos una frecuencia intermedia para los alelos blanco y verde, por lo que esperamos cerca del <span class="math inline">\(50\%\)</span> de heterocigotos (<span class="math inline">\(2pq=2 \frac{1}{2}\frac{1}{2}=\frac{1}{2}\)</span>), pero en realidad no hay ningún individuo heterocigoto ya que los alelos están fijados en las dos poblaciones (diseño de las ovejas de <a href="http://cliparts.co/clipart/2377087" class="uri">http://cliparts.co/clipart/2377087</a> Fuente: Cliparts.co).
</p>
</div>
<p><br />
</p>
<p>Como hicimos para <span class="math inline">\(F_{IS}\)</span>, para definir el índice de fijación de las (sub) poblaciones respecto al total vamos a hacer la resta de la heterocigosidad total esperada respecto a la esperada para las poblaciones y estandarizamos diviendo entre la heterocigosidad total esperada. Esta, no es ni más ni menos que <span class="math inline">\(2\bar{p}\bar{q}\)</span>, con <span class="math inline">\(\bar{p}\)</span> y <span class="math inline">\(\bar{q}=1-\bar{p}\)</span> las frecuencias en toda el <strong>ensemble</strong> en su conjunto. Es decir, el índice de fijación de las subpoblaciones respecto al total será</p>
<p><span class="math display" id="eq:FST">\[\begin{equation}
F_{ST}=\frac{H_T-H_S}{H_T}
\tag{1.6}
\end{equation}\]</span></p>
<p>Finalmente, con la misma lógica podemos definir el índice de fijación entre lo que ocurre <strong>dentro</strong> de las poblaciones y el total como</p>
<p><span class="math display" id="eq:FIT">\[\begin{equation}
F_{IT}=\frac{H_T-H_I}{H_T}
\tag{1.7}
\end{equation}\]</span></p>
<p>Todos estos índices deben ser entendidos en conjunto. De hecho, Wright planteó la relación entre ellos (<span class="citation">S. Wright (<a href="#ref-Wright1943" role="doc-biblioref">1943</a>)</span>; <span class="citation">WRIGHT (<a href="#ref-Wright1951" role="doc-biblioref">1951</a>)</span>) como:</p>
<p><span class="math display" id="eq:fitfstfis9">\[\begin{equation}
F_{ST} = \frac{(F_{IT}-F_{IS})}{(1-F_{IS})}
\tag{1.8}
\end{equation}\]</span></p>
<p>Es posible llegar a otra forma de la relación entre los índices, también muy informativa. Operando con la ecuación <a href="genética-de-poblaciones.html#eq:fitfstfis1">(1.9)</a>, tenemos que</p>
<p><span class="math display" id="eq:fitfstfis1">\[\begin{equation}
(1-F_{IS})F_{ST}=F_{IT}-F_{IS} \therefore \\
F_{IT}=F_{ST}+F_{IS}-F_{ST}F_{IS}
\tag{1.9}
\end{equation}\]</span></p>
<p>Multiplicando por <span class="math inline">\(-1\)</span> y sumando <span class="math inline">\(1\)</span> a ambos lados, tenemos</p>
<p><span class="math display" id="eq:fitfstfis2">\[\begin{equation}
-F_{IT}=-F_{ST}-F_{IS}+F_{ST}F_{IS} F_{ST}+F_{IS} \Leftrightarrow \\
1-F_{IT}=1-F_{ST}-F_{IS}+F_{ST}F_{IS} F_{ST}+F_{IS}
\tag{1.10}
\end{equation}\]</span></p>
<p>Pero <span class="math inline">\((1-F_{ST})(1-F_{IS})=1-F_{ST}-F_{IS}+F_{ST}F_{IS} F_{ST}+F_{IS}\)</span>, por lo que poniendo todo junto, la ecuación <a href="genética-de-poblaciones.html#eq:fitfstfis2">(1.10)</a> se transforma en</p>
<p><span class="math display" id="eq:fitfstfis3">\[\begin{equation}
(1-F_{IT})=(1-F_{ST})(1-F_{IS})
\tag{1.11}
\end{equation}\]</span></p>
<p><br />
</p>
<p>Por lo que vimos, <span class="math inline">\(F_{ST}\)</span> representa la diferenciación genética a causa de la estructuración en poblaciones independientes. En general no resulta trivial interpretar su valor sin el apoyo de más evidencia proveniente de otras fuentes, pero como forma de orientación, <span class="citation">Hartl and Clark (<a href="#ref-HartlClark2007" role="doc-biblioref">2007</a>)</span> proponen una serie de guías prácticas dadas por <span class="citation">Sewall Wright (<a href="#ref-Wright1978v4" role="doc-biblioref">1978</a>)</span> que pueden ayudar a entender la situación. Estas son:</p>
<ul>
<li><p>Valores de <span class="math inline">\(0 \leqslant F_{ST} &lt; 0,05\)</span> indicarían <strong>POCA diferenciación genética</strong></p></li>
<li><p>Valores de <span class="math inline">\(0,05 \leqslant F_{ST} &lt; 0,15\)</span> indicarían <strong>diferenciación genética MODERADA</strong></p></li>
<li><p>Valores de <span class="math inline">\(0,15 \leqslant F_{ST} &lt; 0,25\)</span> indicarían <strong>GRAN diferenciación genética </strong></p></li>
<li><p>Valores de <span class="math inline">\(F_{ST} \geqslant 0,25\)</span> indicarían <strong>MUY GRANDE diferenciación genética </strong></p></li>
</ul>
<p>Sin embargo, como también mencionan <span class="citation">Hartl and Clark (<a href="#ref-HartlClark2007" role="doc-biblioref">2007</a>)</span>, el mismo <span class="citation">Sewall Wright (<a href="#ref-Wright1978v4" role="doc-biblioref">1978</a>)</span> advierte que aún valores de <span class="math inline">\(F_{ST}\)</span> menores a <span class="math inline">\(0,05\)</span> podrían estar indicando una diferenciación genética significativa, por lo que la interpretación de estos valores no es inmediata</p>
<p>Los estadísticos <span class="math inline">\(F\)</span> son muy usados para comprender la diversidad genética aún entre especies cercanas. Así, por ejemplo, <span class="citation">Loáisiga et al. (<a href="#ref-Loasigaetal2012" role="doc-biblioref">2012</a>)</span> en un estudio sobre la diversidad del teosinte, una planta que junto con el maíz (<em>Zea mays</em>) forman el género <em>Zea</em>, comparan seis especies diferentes muy relacionadas entre sí en diferentes regiones de Centroamérica. Como los híbridos F1 de teosinte x maíz son fértiles, estas especies representan un reservorio importante de material genético para mantener la diversidad del maíz o aún para introducir variantes de genes importantes para la producción (resistencia a patógenos, tolerancia a metales pesados, etc.). Para estudiar la diversidad estos autores utilizan un juego de 21 microsatélites (SSR) en 120 individuos, detectando un total de 109 alelos diferentes. A partir del análisis de las frecuencias de los alelos y de los genotipos, calculan para el conjunto de las especies un <span class="math inline">\(F_{IS}=0,0815\)</span>, mientras que el <span class="math inline">\(F_{ST}=0,2017\)</span>. Con estos datos resulta claro que el apartamiento de Hardy-Weinberg dentro de las poblaciones es relativamente pequeño, mientras que la mayor parte de la diferenciación aparece entre especies (el equivalente a las poblaciones en nuestros razonamientos previos). De esta forma, el estudio sugiere que es fundamental la conservación de las diferentes especies ya que es donde reside la mayor parte de la diversidad.</p>
<p><br />
</p>
<hr />
<div id="ejemplo-1.1" class="section level4 unnumbered hasAnchor">
<h4>Ejemplo 1.1<a href="genética-de-poblaciones.html#ejemplo-1.1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consideremos un <strong>ensemble</strong> de poblaciones constituido por las 3 poblaciones que aparecen en la figura <a href="genética-de-poblaciones.html#fig:Festad">1.2</a>. Veamos si existe deficiencia de heterocigotos a algún nivel que nos permita sospechar apareamientos no-aleatorios dentro de las mismas o alguna estructuración geográfica.</p>
<p><br />
</p>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parámetro</th>
<th align="center"><strong>Población 1</strong></th>
<th align="center"><strong>Población 2</strong></th>
<th align="center"><strong>Población 3</strong></th>
<th align="center"><strong>Media</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\({fr(rojo)}\)</span></td>
<td align="center"><span class="math inline">\(p_1=\frac{13}{24}=0,542\)</span></td>
<td align="center"><span class="math inline">\(p_2=\frac{12}{24}=0,500\)</span></td>
<td align="center"><span class="math inline">\(p_3=\frac{7}{24}=0,292\)</span></td>
<td align="center"><span class="math inline">\(\bar{p}=\frac{32}{72}=0,444\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\hat{H}\)</span></td>
<td align="center"><span class="math inline">\(H_1=\frac{5}{12}=0,417\)</span></td>
<td align="center"><span class="math inline">\(H_2=\frac{2}{12}=0,167\)</span></td>
<td align="center"><span class="math inline">\(H_3=\frac{1}{12}=0,083\)</span></td>
<td align="center"><span class="math inline">\(\frac{8}{36}=0,222\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(2p_iq_i\)</span></td>
<td align="center"><span class="math inline">\(2\frac{13}{24}\frac{11}{24}=0,497\)</span></td>
<td align="center"><span class="math inline">\(2\frac{12}{24}\frac{12}{24}=0,500\)</span></td>
<td align="center"><span class="math inline">\(2\frac{7}{24}\frac{17}{24}=0,413\)</span></td>
<td align="center"><span class="math inline">\(0,470\)</span></td>
</tr>
</tbody>
</table>
<p><br />
</p>
<p>Primero vamos a calcular todos los índices de heterocigosidad. La heterocigosidad observada está dada por la ecuación <a href="genética-de-poblaciones.html#eq:HI">(1.2)</a>, es decir (con <span class="math inline">\(n=3\)</span>)</p>
<p><span class="math display">\[\begin{equation}
H_I=\frac{1}{n}\sum_{i=1}^n\hat{H}_i=0,222
\end{equation}\]</span></p>
<p>que es el valor en la última columna del cuadro anterior, en la fila correspondiente a la heterocigosidad observada. Si en cada población los apareamientos fuesen al azar esperaríamos en cada una de ellas una proporción de heterocigotos igual a <span class="math inline">\(2p_iq_i\)</span>, que es la que figura en la tercera línea del cuadro anterior y por lo tanto, la heterocigosidad media esperada, de acuerdo a la ecuación <a href="genética-de-poblaciones.html#eq:HS">(1.3)</a>, es</p>
<p><span class="math display">\[\begin{equation}
H_S=\frac{1}{n}\sum_{i=1}^n2p_iq_i=0,470
\end{equation}\]</span></p>
<p>Finalmente, la heterocigosidad total esperada, de acuerdo a la ecuación <a href="genética-de-poblaciones.html#eq:HT">(1.4)</a>, es</p>
<p><span class="math display">\[\begin{equation}
H_T=2\bar{p}\bar{q}=2\bar{p}(1-\bar{p})=2 \times 0,444 \times (1-0,444)=0,494
\end{equation}\]</span></p>
<p>A partir de estos datos podemos calcular ahora los índices de fijación correspondientes. El primero, el que hace a la estructura interna de las poblaciones está dado por la ecuación <a href="genética-de-poblaciones.html#eq:FIS">(1.5)</a> y es por lo tanto</p>
<p><span class="math display">\[\begin{equation}
F_{IS}=\frac{H_S-{H}_I}{H_S}=\frac{0,470-0,222}{0,470}=0,528
\end{equation}\]</span></p>
<p>Basados en este número, podemos decir que se trata de un valor realmente alto y que por lo tanto <strong>dentro</strong> de las poblaciones (o alguna de ellas) el apareamiento se aparta claramente de lo esperable para las condiciones de <strong>panmixia</strong>.</p>
<p>Veamos que ocurre al segundo nivel, es decir el índice de fijación de las poblaciones respecto al total de los individuos, que podemos calcular a partir de la ecuación <a href="genética-de-poblaciones.html#eq:FST">(1.6)</a></p>
<p><span class="math display">\[\begin{equation}
F_{ST}=\frac{H_T-H_S}{H_T}=\frac{0,494-0,470}{0,494}=0,0486
\end{equation}\]</span></p>
<p>En este caso, el índice de fijación es bastante menor. De acuerdo a las guías prácticas dadas por <span class="citation">Sewall Wright (<a href="#ref-Wright1978v4" role="doc-biblioref">1978</a>)</span>, se trata de un valor (apenas) menor a <span class="math inline">\(0,05\)</span> y por lo tanto indicativo de poca diferenciación genética <strong>entre</strong> poblaciones.</p>
<p>El índice de fijación entre el nivel más y menos inclusivo está dado por la ecuación <a href="genética-de-poblaciones.html#eq:FIT">(1.7)</a>, es decir</p>
<p><span class="math display">\[\begin{equation}
F_{IT}=\frac{H_T-H_I}{H_T}=\frac{0,494-0,222}{0,494}=0,551
\end{equation}\]</span></p>
<p>Para verificación, usando la ecuación <a href="genética-de-poblaciones.html#eq:fitfstfis3">(1.11)</a>, tenemos que</p>
<p><span class="math display">\[\begin{equation}
(1-F_{IT})=(1-F_{ST})(1-F_{IS})=(1-0,0486)(1-0,528)=0,449 \Leftrightarrow F_{IT}=1-0,449=0,551
\end{equation}\]</span></p>
<p>que es igual al valor que obtuvimos directamente. En nuestro caso, entonces, se trata de un <strong>ensemble</strong> de poblaciones donde la mayor parte del deficit de heterocigotos que hemos encontrado se debe un apareamiento no-aleatorio <strong>dentro</strong> de las poblaciones que lo constituyen y en mucho menor medida debido a la diferenciación genética <strong>entre</strong> poblaciones.</p>
<hr />
<p><br />
</p>
<p>Una manera alternativa de pensar en <span class="math inline">\(F_{ST}\)</span> es en términos de partición de la varianza en frecuencias de los alelos. En particular, si pensamos que cada población en un conjunto grande de poblaciones formando el <strong>ensemble</strong> tiene sus propias frecuencias <span class="math inline">\(p_i\)</span> y <span class="math inline">\(q_i\)</span>, la varianza en las frecuencia de <span class="math inline">\(p\)</span>, <span class="math inline">\(\sigma^2_{\bf{p}}\)</span>, estará dada por</p>
<p><span class="math display" id="eq:fs1">\[\begin{equation}
\sigma^2_{\bf{p}}=\frac{1}{n}\sum_{i=1}^n(p_i-\bar{p})^2
\tag{1.12}
\end{equation}\]</span></p>
<p>Lo mismo para <span class="math inline">\(q\)</span>, cuya varianza será igual a la de <span class="math inline">\(p\)</span> y por lo tanto la varianza en frecuencias igual a <span class="math inline">\(\sigma^2_{\bf{p}}\)</span>. Para comparar esta varianza con la del nivel más inclusivo la dividimos entre <span class="math inline">\(2\bar{p}\bar{q}=\bar{p}(1-\bar{p})\)</span> y por lo tanto</p>
<p><span class="math display" id="eq:fst2">\[\begin{equation}
F_{ST}=\frac{2\sigma_{\bf{p}}^2}{2\bar{p}(1-\bar{p})}=\frac{\sigma_{\bf{p}}^2}{\bar{p}(1-\bar{p})}
\tag{1.13}
\end{equation}\]</span></p>
<p>Pese a su importancia, los estadísticos <span class="math inline">\(F\)</span> han estado sujetos a diferentes interpretaciones, sumado a diferentes formas de calcularlos y a partir de fuentes de información diferente, lo que ha generado no poca confusión. Una revisión importante del tema, con un enfoque en lo que pueden aportar diferentes partes del genoma se encuentra en <span class="citation">Holsinger and Weir (<a href="#ref-HolsingerWeir2009" role="doc-biblioref">2009</a>)</span>.</p>
<p><br />
</p>
</div>
<div id="estadísticos-f-práctico" class="section level3 hasAnchor" number="1.8.1">
<h3><span class="header-section-number">1.8.1</span> Estadísticos <em>F</em> (práctico)<a href="genética-de-poblaciones.html#estadísticos-f-práctico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como discutimos previamente, nuestros individuos pertenecen a distintas poblaciones. Además de entender las relaciones entre ellas, usualmente es necesario cuantificar la diferenciación genética entre las mismas y existen diferentes estadísticos que representan esta estructuración en niveles. Algunos de estos son los estadísticos <span class="math inline">\(F\)</span> de Wright, en particular el <span class="math inline">\(F_{ST}\)</span>. Estos se basan en la heterocigosidad observada y esperada a diferentes niveles jerárquicos de la estructura y utilizan como insumos (entre otros) la heterocigosidad observada (<span class="math inline">\(H_o\)</span>), la (a veces) llamada heterocigosidad esperada o diversidad genética dentro de poblaciones (<span class="math inline">\(H_s\)</span>) y la diversidad genética total (<span class="math inline">\(H_t\)</span>, a veces llamada heterocigosidad total). El paquete <strong>hierfstat</strong> posee diversas funciones para trabajar en genética de poblaciones, funciones que me permiten trabajar directamente sobre objetos de la clase “genind”. Por ejemplo, para calcular algunos de estos estadísticos podemos hacer:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="genética-de-poblaciones.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb155-2"><a href="genética-de-poblaciones.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install_github(&quot;jgx65/hierfstat&quot;)</span></span>
<span id="cb155-3"><a href="genética-de-poblaciones.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;hierfstat&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;hierfstat&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:adegenet&#39;:
## 
##     Hs, read.fstat</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="genética-de-poblaciones.html#cb158-1" aria-hidden="true" tabindex="-1"></a>bs.gp<span class="ot">&lt;-</span><span class="fu">basic.stats</span>(genpop)</span>
<span id="cb158-2"><a href="genética-de-poblaciones.html#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(bs.gp<span class="sc">$</span>perloc[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">notch=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk310-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="genética-de-poblaciones.html#cb159-1" aria-hidden="true" tabindex="-1"></a>bs.gp<span class="sc">$</span>overall</span></code></pre></div>
<pre><code>##     Ho     Hs     Ht    Dst    Htp   Dstp    Fst   Fstp    Fis   Dest 
## 0.2881 0.2913 0.3328 0.0415 0.3334 0.0420 0.1246 0.1261 0.0112 0.0593</code></pre>
<p>Prueba a consulta la ayuda de la función <em>basic.stats()</em> para entender lso diversos estadísticos reportados. <strong>De acuerdo al estadístico <span class="math inline">\(F_{ST}\)</span>, ¿Existe diferenciación genética importante entre las distintas poblaciones que forman parte de nuestros datos?</strong></p>
<p>Por ejemplo, si queremos sacar estadísticos <span class="math inline">\(F\)</span> por poblaciones, podemos hacer:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="genética-de-poblaciones.html#cb161-1" aria-hidden="true" tabindex="-1"></a>micol<span class="ot">&lt;-</span><span class="fu">as.factor</span>(tb<span class="sc">$</span>Population.name)</span>
<span id="cb161-2"><a href="genética-de-poblaciones.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(micol)<span class="ot">&lt;-</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">665</span>,<span class="fu">length</span>(<span class="fu">levels</span>(micol)))]</span>
<span id="cb161-3"><a href="genética-de-poblaciones.html#cb161-3" aria-hidden="true" tabindex="-1"></a>betaiovl<span class="ot">&lt;-</span><span class="fu">betas</span>(genpop)<span class="sc">$</span>betaiovl</span>
<span id="cb161-4"><a href="genética-de-poblaciones.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(betaiovl,<span class="at">las=</span><span class="dv">2</span>,<span class="at">cex.names=</span><span class="fl">0.5</span>,<span class="at">col=</span><span class="fu">as.character</span>(<span class="fu">levels</span>(micol)),<span class="at">las=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk325-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="anális-de-pca-usando-paquetes-de-genética-de-poblaciones" class="section level2 hasAnchor" number="1.9">
<h2><span class="header-section-number">1.9</span> Anális de PCA usando paquetes de genética de poblaciones<a href="genética-de-poblaciones.html#anális-de-pca-usando-paquetes-de-genética-de-poblaciones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previamente intentamos identificar la estructura de nuestros datos haciendo un análisis de componentes principales. En ese caso, trabajamos con un paquete estándar y sin transformar los datos en forma adecuada. Obviamente, como era de esperar, no pudimos sacar demasiadas conclusiones de dicha aproximación. Veamos ahora qué ocurre si utilizamos algún paquete específico para realizar dicho análisis. Vamos a utilizar la función <em>indpca()</em> del paquete “hierfstat” y vamos en primer lugar a representar los datos utilizando la coloración de acuerdo a la población a la que pertenecen los individuos. El análisis puede llevar un rato, por lo que no hay que ponerse nervioso.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="genética-de-poblaciones.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COLOREADO POR POBLACIÓN</span></span>
<span id="cb162-2"><a href="genética-de-poblaciones.html#cb162-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">indpca</span>(genpop)</span>
<span id="cb162-3"><a href="genética-de-poblaciones.html#cb162-3" aria-hidden="true" tabindex="-1"></a>micol<span class="ot">&lt;-</span><span class="fu">as.factor</span>(tb<span class="sc">$</span>Population.name)</span>
<span id="cb162-4"><a href="genética-de-poblaciones.html#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(micol)<span class="ot">&lt;-</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">665</span>,<span class="fu">length</span>(<span class="fu">levels</span>(micol)))]</span>
<span id="cb162-5"><a href="genética-de-poblaciones.html#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">col=</span><span class="fu">as.character</span>(micol),<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk315-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>¿Cómo interpretamos el resultado de este análisis?</strong> Por un lado, podemos imaginarnos que los datos se encuentran distribuidos de forma tal que todos los individuos se encuentran dentro de un triángulo. ¿Qué representan los vértices de dicho triángulo? ¿Y las aristas?</p>
<p>En general, los dos primeros ejes de una PCA con poblaciones de todo el mundo tienden a tener esta forma, con los vértices representando poblaciones que divergieron hace muchísimo tiempo: la africana, la europea y la asiática. Más aún, si prestamos atención, el eje 1 de la PCA (que es el que corresponde a la mayor variabilidad) separa netamente a la población africana de las otras dos. La población africana es origen de las otras dos, las que mantuvieron un intercambio mucho más nutrido que con la población africana.</p>
<p>Por otra parte, claramente observamos individuos distribuidos en las aristas entre dos de las superpoblaciones de los vértices: en ese caso, se trata (generalmente) de mestizaje entre las mismas. Por ejemplo, los Mozabite que son poblaciones del norte de África aparecen en la arista que une africanos y europeos, lo que no es de extrañar dado el histórico intercambio genético entre dichos pueblos (europeos y africanos del norte). Por otro lado, en la arista que une europeos y asiáticos aparecen la mayor parte de los grupos nativos americanos. La razón más sencilla para esto es el profundo mestizaje ocurrido con los europeos (especialmente españoles y portugueses) luego de la conquista de nuestro continente por parte de los europeos.</p>
<p>La misma estructura de la PCA podemos observarla ahora considerando las superpoblaciones a las que pertenecen los individuos:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="genética-de-poblaciones.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COLOREADO POR SUPERPOBLACIÓN</span></span>
<span id="cb163-2"><a href="genética-de-poblaciones.html#cb163-2" aria-hidden="true" tabindex="-1"></a>micol2<span class="ot">&lt;-</span><span class="fu">as.factor</span>(tb<span class="sc">$</span>Superpopulation.name)</span>
<span id="cb163-3"><a href="genética-de-poblaciones.html#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(micol2)<span class="ot">&lt;-</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">665</span>,<span class="fu">length</span>(<span class="fu">levels</span>(micol2)))]</span>
<span id="cb163-4"><a href="genética-de-poblaciones.html#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">col=</span><span class="fu">as.character</span>(micol2),<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk316-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="otra-forma-de-hacer-pca" class="section level2 hasAnchor" number="1.10">
<h2><span class="header-section-number">1.10</span> OTRA FORMA DE HACER PCA<a href="genética-de-poblaciones.html#otra-forma-de-hacer-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Otra forma alternativa de realizar la PCA es usando directamente la función <em>dudi.pca()</em> (que utiliza el paquete “hierfstat”). Para esto debemos sacarnos de arriba antes el problema de los datos faltantes.</p>
<div id="imputación" class="section level3 hasAnchor" number="1.10.1">
<h3><span class="header-section-number">1.10.1</span> IMPUTACIÓN<a href="genética-de-poblaciones.html#imputación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una alternativa mucho más eficiente que eliminar los datos es la de imputar los datos faltantes. Existen paquetes generales que me permiten hacer este tipo de operaciones y uno de ellos es <strong>Amelia</strong>. La idea de la imputación es que tanto la columna de interés como el resto de la columnas poseen información que me permiten hacer una “educated guess” del valor faltante. Una de las posibilidades más simple, aunque no la mejor, es sustituir los valores faltantes por la media de la columna. Sin embargo, esta opción ignora la información que pueden aportar las otras columnas. Por ejemplo, una alternativa es considerar que de alguna manera las otras columnas pueden predecir el valor de la columna de interés y por lo tanto, condicional a la información de las otras columnas, puedo obtener una predicción para mi dato faltante. Una de las posibilidades interesantes de la imputación con componente estocástico (es decir, con un componente aleatorio) es que puedo realizarla muchas veces y realizar tantos análisis como juegos de datos imputados, para ver la sensibilidad de mis conclusiones a los datos faltantes. En este caso, vamos a utilizar la forma más sencilla que es la imputación por la media, usando en este caso una función provista directamente en el método de acceso <em>tab()</em> que ya vimos antes.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="genética-de-poblaciones.html#cb164-1" aria-hidden="true" tabindex="-1"></a>x.sinna <span class="ot">&lt;-</span> <span class="fu">tab</span>(genpop, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">NA.method=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb164-2"><a href="genética-de-poblaciones.html#cb164-2" aria-hidden="true" tabindex="-1"></a>pca.x<span class="ot">&lt;-</span><span class="fu">dudi.pca</span>(<span class="at">df =</span> x.sinna, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">2</span>)</span>
<span id="cb164-3"><a href="genética-de-poblaciones.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="genética-de-poblaciones.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s.class</span>(pca.x<span class="sc">$</span>li, <span class="at">fac=</span><span class="fu">pop</span>(genpop), <span class="at">col=</span><span class="fu">funky</span>(<span class="dv">78</span>),<span class="at">clabel=</span><span class="fl">0.65</span>)</span>
<span id="cb164-5"><a href="genética-de-poblaciones.html#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">add.scatter.eig</span>(pca.x<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>],<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>, <span class="at">ratio=</span>.<span class="dv">3</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk320-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Como discutimos previamente, en la PCA existe un ordenamiento de los distintos ejes de acuerdo a la varianza explicada, cada uno explicando menos varianza que el previo. Por lo tanto, es importante poder entender qué número de ejes es necesario conservar para tener una representación adecuada de los datos. Una forma es la visualización en un gráfico de barras, lo que usualmente como “screeplot”. En el gráfico anterior, el inserto abajo a la izquierda representa un gráfico de este tipo. Claramente, los dos primeros ejes capturan una parte importante de la varianza. Veamos en números lo que eso representa:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="genética-de-poblaciones.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PORCENTAJE DE LA VARIANZA EN LOS PRIMEROS EJES</span></span>
<span id="cb165-2"><a href="genética-de-poblaciones.html#cb165-2" aria-hidden="true" tabindex="-1"></a>eig.perc <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>pca.x<span class="sc">$</span>eig<span class="sc">/</span><span class="fu">sum</span>(pca.x<span class="sc">$</span>eig)</span>
<span id="cb165-3"><a href="genética-de-poblaciones.html#cb165-3" aria-hidden="true" tabindex="-1"></a>eig.perc[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] 8.0011120 5.4620389 1.2683616 0.7795280 0.5981882</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="genética-de-poblaciones.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(eig.perc)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1]  8.001112 13.463151 14.731513 15.511041 16.109229</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="genética-de-poblaciones.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(eig.perc)[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>],<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;hasta el eje&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;varianza explicada acumulada&quot;</span>,<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk321-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Observando estos números, así como el gráfico, se aprecia claramente que entre los dos primeros ejes explican un poco más de <span class="math inline">\(13.3\%\)</span> de la varianza, lo que parece muy poco. Sin embargo, cuando consideramos que redujimos las complejidad de miles de columnas con información (marcadores/individuos) a una representación en dos dimensiones, en ese contexto se aprecia la importancia de este resultado.</p>
<p>Por otra parte, una forma de entender la importancia de los distintos marcadores en las dimensiones de la PCA, es decir en los nuevos ejes del sistema coordenado, podemos estudiar las cargas correspondientes. En nuestro caso, podemos llamar directamente a una función capaz de graficar esto o podemos hacer las cuentas sobre el objeto resultante de <em>dudi.pca()</em>:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="genética-de-poblaciones.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LOADING PLOT</span></span>
<span id="cb170-2"><a href="genética-de-poblaciones.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loadingplot</span>(pca.x<span class="sc">$</span>c1<span class="sc">^</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk322-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="genética-de-poblaciones.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SNPS más importantes en EJE1</span></span>
<span id="cb171-2"><a href="genética-de-poblaciones.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>((pca.x<span class="sc">$</span>c1<span class="sc">^</span><span class="dv">2</span>)[<span class="fu">order</span>(pca.x<span class="sc">$</span>c1[,<span class="dv">1</span>],<span class="at">decreasing=</span><span class="cn">TRUE</span>),])</span></code></pre></div>
<pre><code>##                     CS1          CS2
## rs2009296.0 0.001684070 5.076293e-05
## rs7682426.0 0.001657271 1.998290e-06
## rs971329.0  0.001643506 2.796775e-04
## rs7337946.0 0.001643452 1.523123e-04
## rs1521151.0 0.001587603 4.781105e-05
## rs6596059.0 0.001579135 9.189075e-05</code></pre>
<p><strong>¿Qué marcadores tienen mayor influencia en el eje 1?</strong></p>
</div>
</div>
<div id="ensembl-y-biomart" class="section level2 hasAnchor" number="1.11">
<h2><span class="header-section-number">1.11</span> ENSEMBL y biomaRt<a href="genética-de-poblaciones.html#ensembl-y-biomart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta ahora nos centramos en el análisis de nuestros datos, pero usualmente es necesario vincular esta información con la que existe en otras bases de datos. Una herramienta fundamental en este sentido es el paquete “biomaRt” de <strong>bioconductor</strong> (un proyecto paraguas para paquetes de R en el área de genómica y biología molecular). Vamos a experimentar brevemente con “biomaRt” y explorar algunas posibilidades sencillas, pero las capacidades del paquete son enormes. Lo primero con “biomaRt” es definir los datos con los que vamos a trabajar. Para ello es necesario definir la base de datos (Mart), así como el juego de datos de nuestro interés. Comencemos trabajando con la base de datos de SNPs (“ENSEMBL_MART_SNP”) y el juego de datos de humano (“hsapiens_snp”).</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="genética-de-poblaciones.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;biomaRt&quot;</span>)</span>
<span id="cb173-2"><a href="genética-de-poblaciones.html#cb173-2" aria-hidden="true" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_SNP&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;hsapiens_snp&quot;</span>)</span></code></pre></div>
<p>Luego de habernos conectado a la base de datos, podemos ver los filtros que podemos aplicar y los atributos de la base de datos. Los filtros serán nuestras herramientas para elegir que parte de los datos cumplen con nuestros criterios de busca, mientras que los atributos representan los campos de la base de datos queremos mostrar.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="genética-de-poblaciones.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Los primeros filtros</span></span>
<span id="cb174-2"><a href="genética-de-poblaciones.html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listFilters</span>(ensembl))</span></code></pre></div>
<pre><code>##           name              description
## 1     chr_name Chromosome/scaffold name
## 2        start                    Start
## 3          end                      End
## 4   band_start               Band Start
## 5     band_end                 Band End
## 6 marker_start             Marker Start</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="genética-de-poblaciones.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># los primeros atributos</span></span>
<span id="cb176-2"><a href="genética-de-poblaciones.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listAttributes</span>(ensembl))</span></code></pre></div>
<pre><code>##                        name                             description page
## 1                 refsnp_id                            Variant name  snp
## 2             refsnp_source                          Variant source  snp
## 3 refsnp_source_description              Variant source description  snp
## 4                  chr_name                Chromosome/scaffold name  snp
## 5               chrom_start Chromosome/scaffold position start (bp)  snp
## 6                 chrom_end   Chromosome/scaffold position end (bp)  snp</code></pre>
<p>Veamos si podemos elegir al azar unos 300 marcadores (SNPs) de nuestros datos y recuperar alguna información de los mismos. Elegimos un número relativamente pequeño porque la consulta es a través de una interface vía web y por lo tanto la descarga lleva su tiempo y puede aún llegar a verse interrumpida si el tiempo es excesivo. En caso de querer recuperar información de muchos marcadores a la vez, existen diferentes posibilidades, básicamente partiendo las consultas en “batchs” de tamaño adecuado y luego juntando los resultados. En nuestro caso, elegimos al azar 300 marcadores. La consulta es sencilla y se hace usando la función <em>getBM()</em>. Luego de hacer la consulta, elegimos representar solamente aquellos SNPs que tienen algún gen asociado.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="genética-de-poblaciones.html#cb178-1" aria-hidden="true" tabindex="-1"></a>geneSNP<span class="ot">&lt;-</span><span class="fu">getBM</span>(<span class="at">attributes=</span><span class="fu">c</span>(<span class="st">&quot;refsnp_id&quot;</span>, <span class="st">&quot;associated_gene&quot;</span>, <span class="st">&quot;clinical_significance&quot;</span>,<span class="st">&quot;phenotype_name&quot;</span>,<span class="st">&quot;associated_variant_risk_allele&quot;</span>,<span class="st">&quot;p_value&quot;</span>), <span class="at">filters=</span><span class="st">&quot;snp_filter&quot;</span>, <span class="at">values=</span><span class="fu">rownames</span>(ngeno)[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">72000</span>,<span class="dv">300</span>)], <span class="at">mart=</span>ensembl, <span class="at">uniqueRows=</span><span class="cn">TRUE</span>)</span>
<span id="cb178-2"><a href="genética-de-poblaciones.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(geneSNP[geneSNP<span class="sc">$</span>associated_gene<span class="sc">!=</span><span class="st">&quot;&quot;</span>,])</span></code></pre></div>
<pre><code>##   refsnp_id associated_gene clinical_significance phenotype_name
## 2  rs880315           CASZ1                                     
## 3  rs880315           CASZ1                                     
## 4  rs880315           CASZ1                                     
## 5  rs880315           CASZ1                                     
## 7  rs880315           CASZ1                                     
## 9  rs880315           CASZ1                                     
##   associated_variant_risk_allele p_value
## 2                              C   2e-10
## 3                              T   8e-12
## 4                                  5e-09
## 5                              T   6e-09
## 7                              C   2e-26
## 9                              C   1e-30</code></pre>
<p>Usando la misma idea y luego la web, identificar la información para el SNP “rs5174”. <strong>¿Se trata de un alelo de riesgo para qué enfermedad?</strong></p>
<p>Pero las bases de datos y los juegos de datos disponibles son muchos. Una forma de explorar estos datos es listar las posibles bases y luego, eligiendo una, listar los juegos de datos. Por ejemplo, podemos primero listar los “Mart” posibles y luego, para alguno que nos interese listar los juegos de datos correspondientes. Como en algunos casos son muchos, conviene usar la función <em>head()</em> para tener idea del contenido.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="genética-de-poblaciones.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">listMarts</span>()</span></code></pre></div>
<pre><code>##                biomart                version
## 1 ENSEMBL_MART_ENSEMBL      Ensembl Genes 110
## 2   ENSEMBL_MART_MOUSE      Mouse strains 110
## 3     ENSEMBL_MART_SNP  Ensembl Variation 110
## 4 ENSEMBL_MART_FUNCGEN Ensembl Regulation 110</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="genética-de-poblaciones.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listDatasets</span>(<span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>)))</span></code></pre></div>
<pre><code>##                        dataset                           description
## 1 abrachyrhynchus_gene_ensembl Pink-footed goose genes (ASM259213v1)
## 2     acalliptera_gene_ensembl      Eastern happy genes (fAstCal1.2)
## 3   acarolinensis_gene_ensembl       Green anole genes (AnoCar2.0v2)
## 4    acchrysaetos_gene_ensembl       Golden eagle genes (bAquChr1.2)
## 5    acitrinellus_gene_ensembl        Midas cichlid genes (Midas_v5)
## 6    amelanoleuca_gene_ensembl       Giant panda genes (ASM200744v2)
##       version
## 1 ASM259213v1
## 2  fAstCal1.2
## 3 AnoCar2.0v2
## 4  bAquChr1.2
## 5    Midas_v5
## 6 ASM200744v2</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="genética-de-poblaciones.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listDatasets</span>(<span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_SNP&quot;</span>)))</span></code></pre></div>
<pre><code>##                  dataset
## 1            btaurus_snp
## 2      btaurus_structvar
## 3            chircus_snp
## 4       clfamiliaris_snp
## 5 clfamiliaris_structvar
## 6             drerio_snp
##                                                                      description
## 1   Cow Short Variants (SNPs and indels excluding flagged variants) (ARS-UCD1.2)
## 2                                           Cow Structural Variants (ARS-UCD1.2)
## 3        Goat Short Variants (SNPs and indels excluding flagged variants) (ARS1)
## 4 Dog Short Variants (SNPs and indels excluding flagged variants) (ROS_Cfam_1.0)
## 5                                         Dog Structural Variants (ROS_Cfam_1.0)
## 6 Zebrafish Short Variants (SNPs and indels excluding flagged variants) (GRCz11)
##        version
## 1   ARS-UCD1.2
## 2   ARS-UCD1.2
## 3         ARS1
## 4 ROS_Cfam_1.0
## 5 ROS_Cfam_1.0
## 6       GRCz11</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="genética-de-poblaciones.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">listDatasets</span>(<span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_FUNCGEN&quot;</span>))</span></code></pre></div>
<pre><code>##                          dataset                                 description
## 1      hsapiens_external_feature Human Other Regulatory Regions (GRCh38.p14)
## 2  hsapiens_mirna_target_feature     Human miRNA Target Regions (GRCh38.p14)
## 3    hsapiens_regulatory_feature      Human Regulatory Features (GRCh38.p14)
## 4     mmusculus_external_feature     Mouse Other Regulatory Regions (GRCm39)
## 5 mmusculus_mirna_target_feature         Mouse miRNA Target Regions (GRCm39)
## 6   mmusculus_regulatory_feature          Mouse Regulatory Features (GRCm39)
##      version
## 1 GRCh38.p14
## 2 GRCh38.p14
## 3 GRCh38.p14
## 4     GRCm39
## 5     GRCm39
## 6     GRCm39</code></pre>
<p>Si quisiésemos buscar juegos de datos del <strong>Mart</strong> “ENSEMBL_MART_SNP”, podríamos hacer</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="genética-de-poblaciones.html#cb188-1" aria-hidden="true" tabindex="-1"></a>mart<span class="ot">&lt;-</span><span class="fu">listDatasets</span>(<span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_SNP&quot;</span>))</span>
<span id="cb188-2"><a href="genética-de-poblaciones.html#cb188-2" aria-hidden="true" tabindex="-1"></a>mart[<span class="fu">grep</span>(<span class="st">&quot;hsapiens&quot;</span>,mart<span class="sc">$</span>dataset),]</span></code></pre></div>
<pre><code>##                   dataset
## 12           hsapiens_snp
## 13       hsapiens_snp_som
## 14     hsapiens_structvar
## 15 hsapiens_structvar_som
##                                                                               description
## 12         Human Short Variants (SNPs and indels excluding flagged variants) (GRCh38.p14)
## 13 Human Somatic Short Variants (SNPs and indels excluding flagged variants) (GRCh38.p14)
## 14                                                 Human Structural Variants (GRCh38.p14)
## 15                                         Human Somatic Structural Variants (GRCh38.p14)
##       version
## 12 GRCh38.p14
## 13 GRCh38.p14
## 14 GRCh38.p14
## 15 GRCh38.p14</code></pre>
<p>identificando nuestro juego de datos que usamos previamente (“hsapiens_snp”), pero también otros juegos de datos de variantes estructurales y de variantes somáticas.</p>
<p>Veamos si podemos trabajar un poquito con genes, en lugar de con variantes. Para eso, vamos a seleccionar el <strong>Mart</strong> “ensembl” y dentro de este, el juego de datos del “hsapiens_gene_ensembl”, variante del genoma humano “GRCh37.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="genética-de-poblaciones.html#cb190-1" aria-hidden="true" tabindex="-1"></a>ensembl2<span class="ot">&lt;-</span><span class="fu">useEnsembl</span>(<span class="at">biomart=</span><span class="st">&quot;ensembl&quot;</span>, <span class="at">dataset=</span><span class="st">&quot;hsapiens_gene_ensembl&quot;</span>, <span class="at">GRCh=</span><span class="dv">37</span>)</span>
<span id="cb190-2"><a href="genética-de-poblaciones.html#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="genética-de-poblaciones.html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Los primeros filtros</span></span>
<span id="cb190-4"><a href="genética-de-poblaciones.html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listFilters</span>(ensembl2))</span></code></pre></div>
<pre><code>##              name              description
## 1 chromosome_name Chromosome/scaffold name
## 2           start                    Start
## 3             end                      End
## 4      band_start               Band Start
## 5        band_end                 Band End
## 6    marker_start             Marker Start</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="genética-de-poblaciones.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># los primeros atributos</span></span>
<span id="cb192-2"><a href="genética-de-poblaciones.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">listAttributes</span>(ensembl2))</span></code></pre></div>
<pre><code>##                            name                  description         page
## 1               ensembl_gene_id               Gene stable ID feature_page
## 2       ensembl_gene_id_version       Gene stable ID version feature_page
## 3         ensembl_transcript_id         Transcript stable ID feature_page
## 4 ensembl_transcript_id_version Transcript stable ID version feature_page
## 5            ensembl_peptide_id            Protein stable ID feature_page
## 6    ensembl_peptide_id_version    Protein stable ID version feature_page</code></pre>
<p>Utilizando la lista de SNPs que usamos previamente, vamos a seleccionar los genes asociados a alguna de esas variantes (SNPs) y luego vamos a buscarlos en la base de datos, extrayendo algunas características de los mismos.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="genética-de-poblaciones.html#cb194-1" aria-hidden="true" tabindex="-1"></a>genesabuscar<span class="ot">&lt;-</span><span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">unique</span>(geneSNP<span class="sc">$</span>associated_gene),<span class="cf">function</span>(x) <span class="fu">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)))</span>
<span id="cb194-2"><a href="genética-de-poblaciones.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="genética-de-poblaciones.html#cb194-3" aria-hidden="true" tabindex="-1"></a>algunosgenes<span class="ot">&lt;-</span><span class="fu">getBM</span>(<span class="at">attributes=</span><span class="fu">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;external_gene_name&quot;</span>,<span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;description&quot;</span>,<span class="st">&quot;percentage_gene_gc_content&quot;</span>,<span class="st">&quot;gene_biotype&quot;</span>), <span class="at">filters=</span><span class="st">&quot;external_gene_name&quot;</span>, <span class="at">values=</span>genesabuscar, <span class="at">mart=</span>ensembl2, <span class="at">uniqueRows=</span><span class="cn">TRUE</span>)</span>
<span id="cb194-4"><a href="genética-de-poblaciones.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(algunosgenes)</span></code></pre></div>
<pre><code>##   ensembl_gene_id external_gene_name chromosome_name
## 1 ENSG00000179242               CDH4              20
## 2 ENSG00000248522             SBF1P1               8
## 3 ENSG00000088812               ATRN              20
## 4 ENSG00000164161               HHIP               4
## 5 ENSG00000164162            ANAPC10               4
## 6 ENSG00000173575               CHD2              15
##                                                                 description
## 1    cadherin 4, type 1, R-cadherin (retinal) [Source:HGNC Symbol;Acc:1763]
## 2          SET binding factor 1 pseudogene 1 [Source:HGNC Symbol;Acc:31098]
## 3                                    attractin [Source:HGNC Symbol;Acc:885]
## 4               hedgehog interacting protein [Source:HGNC Symbol;Acc:14866]
## 5      anaphase promoting complex subunit 10 [Source:HGNC Symbol;Acc:24077]
## 6 chromodomain helicase DNA binding protein 2 [Source:HGNC Symbol;Acc:1917]
##   percentage_gene_gc_content   gene_biotype
## 1                      51.80 protein_coding
## 2                      60.70     pseudogene
## 3                      40.34 protein_coding
## 4                      36.07 protein_coding
## 5                      37.19 protein_coding
## 6                      38.96 protein_coding</code></pre>
<p>Veamos si existe variabilidad en el contenido <strong>G+C</strong> de los genes. <strong>¿Qué esperas en este sentido? Si hubiese variación, será grande o pequeña?</strong> La manera más sencilla de visualizarlo es haciendo un histograma del contenido <strong>G+C</strong>:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="genética-de-poblaciones.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(algunosgenes<span class="sc">$</span>percentage_gene_gc_content,<span class="dv">20</span>,<span class="at">mai=</span><span class="st">&quot;contenido GC de genes seleccionados&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;G+C (%)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk412-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Finalmente, a partir de estos datos vamos a calcular el contenido <strong>GC</strong> (o <strong>G+C</strong>) promedio de los genes que pertenecen a cada cromosoma.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="genética-de-poblaciones.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el contendio GC por cromosoma</span></span>
<span id="cb197-2"><a href="genética-de-poblaciones.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(percentage_gene_gc_content<span class="sc">~</span> chromosome_name,<span class="at">data=</span> algunosgenes,<span class="at">varwidth=</span><span class="cn">TRUE</span>,<span class="at">xlab=</span><span class="st">&quot;Cromosoma&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;G+C (%)&quot;</span>,<span class="at">col=</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">655</span>,<span class="fu">length</span>(<span class="fu">unique</span>(algunosgenes<span class="sc">$</span>chromosome_name)))])</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk413-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="genética-de-poblaciones.html#cb198-1" aria-hidden="true" tabindex="-1"></a>(tag<span class="ot">&lt;-</span><span class="fu">aggregate</span>(algunosgenes<span class="sc">$</span>percentage_gene_gc_content,<span class="at">by=</span><span class="fu">list</span>(<span class="st">&quot;chr&quot;</span><span class="ot">=</span>algunosgenes<span class="sc">$</span>chromosome_name),mean))</span></code></pre></div>
<pre><code>##    chr        x
## 1    1 49.72500
## 2    2 40.72333
## 3    4 41.58000
## 4    5 47.07000
## 5    6 39.06000
## 6    7 38.55000
## 7    8 43.61167
## 8   10 41.36500
## 9   12 38.13000
## 10  13 40.02000
## 11  15 38.96000
## 12  17 38.41000
## 13  18 42.32667
## 14  19 45.97333
## 15  20 44.70000</code></pre>
</div>
<div id="h-w-la-frecuencia-de-heterocigotas-en-función-de-la-frecuencia-alélica-intro-teórica" class="section level2 hasAnchor" number="1.12">
<h2><span class="header-section-number">1.12</span> H-W: la frecuencia de heterocigotas en función de la frecuencia alélica (intro teórica)<a href="genética-de-poblaciones.html#h-w-la-frecuencia-de-heterocigotas-en-función-de-la-frecuencia-alélica-intro-teórica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En un locus con dos alelos, ¿a qué frecuencia del alelo <span class="math inline">\(p\)</span> podemos
observar la mayor frecuencia de heterocigotas, asumiendo que la
población se encuentra en equilibrio de Hardy-Weinberg?
La alternativa más sencilla para tener una idea aproximada del
comportamiento del número de heterocigotas bajo estos supuestos es
graficar la misma como función de <span class="math inline">\(p\)</span>, <span class="math inline">\(2pq=2p(1-p)\)</span> en cualquier
software que permita graficar funciones, calculadora, o aún en una
planilla electrónica, por ejemplo generando una serie en el intervalo
0-1. La figura <a href="genética-de-poblaciones.html#fig:HWheterop">1.4</a> es el resultado de graficar esta función, donde
se ve que la máxima frecuencia de heterocigotas se encuentra en el
entorno de <span class="math inline">\(p=0,5\)</span>, o sea en frecuencias intermedias de los dos alelos y
que la máxima proporción de heterocigotas esperable para una población
en equilibrio de HW es <span class="math inline">\(0,5\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:HWheterop"></span>
<img src="HWEA2022_files/figure-html/HWheterop-1.png" alt="Frecuencia de heterocigotas en función de la frecuencia del alelo $p$ en un modelo de un locus con dos alelos, bajo equilibrio Hardy-Weinberg. En azul la frecuencia de los heterocigotas, rojo y verde los homocigotas." width="672" />
<p class="caption">
Figura 1.4: Frecuencia de heterocigotas en función de la frecuencia del alelo <span class="math inline">\(p\)</span> en un modelo de un locus con dos alelos, bajo equilibrio Hardy-Weinberg. En azul la frecuencia de los heterocigotas, rojo y verde los homocigotas.
</p>
</div>
<p>Una forma más precisa, complementaria con la anterior, es el estudio
analítico de esta función. Es decir, dada la función
<span class="math inline">\(f_{Het}(p)=2pq=2p(1-p)=2p-2p^2\)</span>, podemos reconocer los extremos relativos
(máximos y mínimos) de la misma como los lugares donde la pendiente de
la recta tangente es igual a cero, o lo que es equivalente, los puntos
donde la derivada primera se hace cero. Por lo tanto, derivando la
función obtenemos:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
f_{Het}(p)=2pq=2p(1-p)=2p-2p^2\\
\frac{d f_{Het}}{dp}=2-4p\\
2-4p=0  \Leftrightarrow p=\frac{1}{2}
\end{split}
\end{equation}\]</span></p>
<p>Es decir, la función tiene un solo máximo o mínimo en <span class="math inline">\(p=\frac{1}{2}=0,5\)</span>, pero para
reconocer de cuál de los dos se trata es necesario ver el signo de la
derivada segunda (lo que hacemos volviendo a derivar la derivada primera):</p>
<p><span class="math display">\[\begin{equation}
\frac{d^2 f_{Het}(p)}{dp^2}=-4
\end{equation}\]</span></p>
<p>Como el signo es negativo, se trata de un máximo. Más aún, la forma de función original
(<span class="math inline">\(f_{Het}=2p-2p^2\)</span>) es claramente reconocible como la de una parábola
con forma de “U” invertida y cuyas intersecciones con el eje de las
abcsisas (raíces) son 0 y 1, por lo que por simetría el vértice debe
estar en el punto medio, es decir <span class="math inline">\(\frac{1}{2}\)</span>. Sustituyendo, tenemos:</p>
<p><span class="math display">\[\begin{equation}
f_{Het_{max}}(p=\frac{1}{2})=2pq=2 \frac{1}{2} (1-\frac{1}{2})= 2 \frac{1}{2} \frac{1}{2} = \frac{1}{2}
\end{equation}\]</span></p>
<p>Veamos ahora que ocurre con nuestros datos. Para eso vamos a calcular la proporción de genotipos heterocigotas para cada marcador.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="genética-de-poblaciones.html#cb200-1" aria-hidden="true" tabindex="-1"></a>HeteSNPs<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan,<span class="dv">1</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">length</span>(x))</span></code></pre></div>
<p>Ahora, como para cada marcador ya tenemos calculada la frecuencia alélica, podemos “plotear” la frecuencia de heterocigotas observada por marcador, en función de la frecuencia alélica del marcador. Debemos recordar que al tratarese de solo dos alelos por <em>locus</em>, se trata de un problema simétrico respecto a qué alelo elegimos, ya que si uno tienen frecuencia <span class="math inline">\(p\)</span> el otro tendrá frecuencia <span class="math inline">\((1-p)\)</span> y la frecuencia esperada de heterocigotos es función <span class="math inline">\(p(1-p)\)</span> (de hecho, es <span class="math inline">\(2pq=2p(1-q)\)</span>). Además, podemos plotear (en rojo) la curva teórica de la frecuencia esperada.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="genética-de-poblaciones.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(freqSNPSpopmas20,HeteSNPs,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="fl">0.2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">ylab=</span><span class="st">&quot;Heterocigotas&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;frecuencia alélica&quot;</span>)</span>
<span id="cb201-2"><a href="genética-de-poblaciones.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb201-3"><a href="genética-de-poblaciones.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">2</span><span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk501-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="genética-de-poblaciones.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>¿Qué observas en este gráfico? ¿La proporción de heterocigotos se distribuye de acuerdo a la curva teórica (considerando la variación aleatoria) o existe un apartamiento sistemático de la misma?</strong></p>
<p>Claramente, como ya lo habíamos discutido antes, existe un apartamiento sistemático, con menor número de heterocigotos que los esperados. <strong>¿A qué se debe este fenómeno?</strong></p>
<p>El fenómeno anterior es producto de la subsidivisión poblacional y está estrechamente relacionado con el efecto “Wahlund” (que a decir verdad es exactamente el fenómeno opuesto) y con los estadísticos <span class="math inline">\(F\)</span> que veremos más adelante. Cuando en un <strong>ensemble</strong> de poblaciones, cada una de ellas se encuentra en equilibrio Hardy-Weinberg pero las frecuencias alélicas difieren entre las distintas poblaciones, el <strong>ensemble</strong> de poblaciones considerado en su conjunto como una sola gran población <strong>NO SE ENCUENTRA EN EQUILIBRIO HARDY-WEINBERG</strong>, resultando en un falta sistemática de heterocigotas. ¿Cómo puede ser que si cada población se encuentra en equilibrio Hardy-Weinberg el conjunto de individuos no lo esté? La razón es sencilla: las frecuencias esperadas para los genotipos son funciones no lineales de las frecuencias alélicas, es decir <span class="math inline">\(p_i^2\)</span>, <span class="math inline">\(2p_iq_i\)</span> y <span class="math inline">\(q_i^2\)</span>, por lo que el promedio de las frecuencias alélicas no será un buen estimador del promedio de los genotipos.</p>
</div>
<div id="heterocigosidad" class="section level2 hasAnchor" number="1.13">
<h2><span class="header-section-number">1.13</span> Heterocigosidad<a href="genética-de-poblaciones.html#heterocigosidad" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Veamos ahora que ocurre con la proporción de <em>loci</em> heterocigotas para los distintos individuos de nuestra población. Para eso vamos a calcular primero dicha proporción:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="genética-de-poblaciones.html#cb203-1" aria-hidden="true" tabindex="-1"></a>HeteIndiv<span class="ot">&lt;-</span><span class="fu">apply</span>(ngenot.estan,<span class="dv">2</span>,<span class="cf">function</span>(x)<span class="fu">sum</span>(x<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb203-2"><a href="genética-de-poblaciones.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HeteIndiv)</span></code></pre></div>
<pre><code>## HGDP00479 HGDP00985 HGDP01094 HGDP00982 HGDP00911 HGDP01202 
## 0.2824911 0.2709695 0.2837819 0.2581296 0.2889179 0.3015106</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="genética-de-poblaciones.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(HeteIndiv,<span class="dv">80</span>,<span class="at">xlab=</span><span class="st">&quot;Heterocigosidad por individuo&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk550-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Claramente, al observar el histograma notamos que aparentemente hay diferentes grupos de individuos con diferente nivel de heterocigosidad promedio en sus <em>loci</em>. Veamos si podemos identificar esto con diferentes poblaciones, por ejemplo.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="genética-de-poblaciones.html#cb206-1" aria-hidden="true" tabindex="-1"></a>micol<span class="ot">&lt;-</span><span class="fu">as.factor</span>(tb<span class="sc">$</span>Population.name)</span>
<span id="cb206-2"><a href="genética-de-poblaciones.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(micol)<span class="ot">&lt;-</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">665</span>,<span class="fu">length</span>(<span class="fu">levels</span>(micol)))]</span>
<span id="cb206-3"><a href="genética-de-poblaciones.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(HeteIndiv<span class="sc">~</span>tb<span class="sc">$</span>Population.name,<span class="at">col=</span><span class="fu">levels</span>(micol),<span class="at">varwidth=</span><span class="cn">TRUE</span>,<span class="at">las=</span><span class="dv">2</span>,<span class="at">cex.axis=</span><span class="fl">0.29</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Heterocigosidad&quot;</span>,<span class="at">outline=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk551-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>En el <strong>boxplot</strong> anterior se observa que la distribución de los valores de heterocigosidad es diferente para distintas poblaciones, alguna con valores relativamente bajos. Ahora estamos hablando de la heterocigosidad a nivel de individuos pertenecientes a diferentes poblaciones. Una forma sencilla de cuantificar este efecto (aunque no necesariamente la mejor) es a través de la media para cada población. Veamos si identificamos las poblaciones con menor nivel de heterocigosidad observada.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="genética-de-poblaciones.html#cb207-1" aria-hidden="true" tabindex="-1"></a>agHI<span class="ot">&lt;-</span><span class="fu">aggregate</span>(HeteIndiv,<span class="at">by=</span><span class="fu">list</span>(<span class="st">&quot;Population.name&quot;</span><span class="ot">=</span>tb<span class="sc">$</span>Population.name),mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb207-2"><a href="genética-de-poblaciones.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(agHI[<span class="fu">order</span>(agHI<span class="sc">$</span>x),],<span class="dv">15</span>)</span></code></pre></div>
<pre><code>##            Population.name         x
## 69                   Surui 0.2087682
## 35               Karitiana 0.2214389
## 59     Papuan,Papuan Sepik 0.2226655
## 56                  Papuan 0.2260231
## 57            Papuan Sepik 0.2264213
## 58 Papuan,Papuan Highlands 0.2271697
## 62                 Piapoco 0.2349835
## 63                    Pima 0.2385757
## 20               Colombian 0.2424252
## 33      Ju|&#39;hoan North,San 0.2428591
## 32          Ju|&#39;hoan North 0.2428660
## 65                     San 0.2432573
## 42              Mayan,Maya 0.2489151
## 14            Bougainville 0.2504697
## 44             Mbuti,Mbuti 0.2569555</code></pre>
<p><strong>¿Se te ocurre alguna explicación para interpretar las poblaciones que poseen menor heterocigosidad promedio observada?</strong></p>
<p>De hecho, cuando los apareamientos no son aleatorios dentro de la población hay una pérdida de heterocigotos y un aumento consiguiente de los homocigotos. El <strong>coeficiente de endogamia <em>F</em> </strong> es igual a la probabilidad de que los alelos en un gen cualquiera de un individuo endogámico sean idénticos-por-ascendencia (<strong>IBD</strong>). En forma equivalente, el <strong>coeficiente de endogamia</strong> es la proporción de los <em>loci</em> en un individuo endogámico en que los alelos son idénticos-por-ascendencia. Las nuevas frecuencias para una población con un coeficiente de endogamia <em>F</em> estarán dadas por</p>
<p><span class="math display">\[\begin{equation}
{fr(A_1A_1)}=p^2(1-F)+pF \\
{fr(A_1A_2)}=2pq(1-F) \\
{fr(A_2A_2)}=q^2(1-F)+qF
\end{equation}\]</span></p>
<p>En poblaciones de tamaño reducido, la endogamia se incrementa (aumenta el apareamiento entre parientes), se incrementa su coeficiente <span class="math inline">\(F\)</span> y por lo tanto se reduce el número de heterocigotos respecto a lo esperado en ausencia de endogamia ya que <span class="math inline">\(2pq(1-F)&lt;2pq\)</span>. Si observas el ordenamiento de la tabla anterior, se trata de poblaciones de grupos indígenas diezmados con un tamaño poblacional muy reducido, por lo que en la medida de que no exista intercambio genético con otros grupos, la endogamia se incrementará. Este efecto también se puede apreciar a nivel de la super-poblaciones a las que pertenecen los distintos grupos:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="genética-de-poblaciones.html#cb209-1" aria-hidden="true" tabindex="-1"></a>micol2<span class="ot">&lt;-</span><span class="fu">as.factor</span>(tb<span class="sc">$</span>Superpopulation.name)</span>
<span id="cb209-2"><a href="genética-de-poblaciones.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(micol2)<span class="ot">&lt;-</span><span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">665</span>,<span class="fu">length</span>(<span class="fu">levels</span>(micol2)))]</span>
<span id="cb209-3"><a href="genética-de-poblaciones.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(HeteIndiv<span class="sc">~</span>tb<span class="sc">$</span>Superpopulation.name,<span class="at">col=</span><span class="fu">levels</span>(micol2),<span class="at">varwidth=</span><span class="cn">TRUE</span>,<span class="at">las=</span><span class="dv">2</span>,<span class="at">cex.axis=</span><span class="fl">0.5</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Heterocigosidad&quot;</span>,<span class="at">outline=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="HWEA2022_files/figure-html/chunk553-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>¿Cuáles son las poblaciones con mayor nivel de heterocigosidad? ¿Alguna hipótesis al respecto? Además del tamaño poblacional, ¿qué otros factores pueden incrementar la heterocigosidad (pensar en el fenomeno opuesto al inbreeding)?</strong></p>
<hr />

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-castle1903" class="csl-entry">
Castle, W. E. 1903. <span>“<span class="nocase"><span>T</span>he laws of <span>G</span>alton and <span>M</span>endel and some laws governing race improvement</span>.”</span> <em>Proceedings of the American Academy of Arts and Sciences</em> 35 (8): 233–42.
</div>
<div id="ref-pmid17779291" class="csl-entry">
Hardy, G. H. 1908. <span>“<span><span>M</span><span>E</span><span>N</span><span>D</span><span>E</span><span>L</span><span>I</span><span>A</span><span>N</span> <span>P</span><span>R</span><span>O</span><span>P</span><span>O</span><span>R</span><span>T</span><span>I</span><span>O</span><span>N</span><span>S</span> <span>I</span><span>N</span> <span>A</span> <span>M</span><span>I</span><span>X</span><span>E</span><span>D</span> <span>P</span><span>O</span><span>P</span><span>U</span><span>L</span><span>A</span><span>T</span><span>I</span><span>O</span><span>N</span></span>.”</span> <em>Science</em> 28 (706): 49–50.
</div>
<div id="ref-HartlClark2007" class="csl-entry">
Hartl, Daniel L, and Andrew G Clark. 2007. <em>Principles of Population Genetics</em>. 4th. ed. Sinauer.
</div>
<div id="ref-HolsingerWeir2009" class="csl-entry">
Holsinger, K. E., and B. S. Weir. 2009. <span>“<span class="nocase"><span>G</span>enetics in geographically structured populations: defining, estimating and interpreting <span>F</span>(<span>S</span><span>T</span>)</span>.”</span> <em>Nat Rev Genet</em> 10 (9): 639–50.
</div>
<div id="ref-Loasigaetal2012" class="csl-entry">
Loáisiga, C. H., O. Rocha, A. K. Brantestam, B. Salomon, and A. Merker. 2012. <span>“Genetic Diversity and Gene Flow in Six Accessions of Meso-America Teosintes.”</span> <em>Genet Resour Crop Evol</em> 59: 95–111.
</div>
<div id="ref-pmid26354973" class="csl-entry">
Rosenberg, N. A., and J. T. Kang. 2015. <span>“<span class="nocase"><span>G</span>enetic <span>D</span>iversity and <span>S</span>ocietally <span>I</span>mportant <span>D</span>isparities</span>.”</span> <em>Genetics</em> 201 (1): 1–12.
</div>
<div id="ref-deVries1900" class="csl-entry">
Vries, H. de. 1900. <span>“<span class="nocase"><span>S</span>ur la loi de disjonction des Hybrides</span>.”</span> <em>Comptes Rendus de l‘Acad<span>é</span>mie Des Sciences</em> 130 (-): 845–47.
</div>
<div id="ref-weinberg1908" class="csl-entry">
Weinberg, W. 1908. <span>“<span class="nocase"><span>Ü</span>ber den Nachweis der Vererbung beim Menschen</span>.”</span> <em>Jahreshefte Des Vereins f<span>ü</span>r Vaterl<span>ä</span>ndische Naturkunde in W<span>ü</span>rttemberg.</em> 64: 369–82.
</div>
<div id="ref-Wright1943" class="csl-entry">
Wright, S. 1943. <span>“<span class="nocase"><span>G</span>enetics <span>I</span>solation by <span>D</span>istance</span>.”</span> <em>Genetics</em> 28 (2): 114–38.
</div>
<div id="ref-Wright1951" class="csl-entry">
WRIGHT, S. 1951. <span>“<span class="nocase"><span>A</span>nn <span>E</span>ugen<span>T</span>he genetical structure of populations</span>.”</span> <em>Ann Eugen</em> 15 (4): 323–54.
</div>
<div id="ref-Wright1978v4" class="csl-entry">
Wright, Sewall. 1978. <em>Evolution and the Genetics of Populations</em>. Chicago Press.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Aunque la misma ya había sido claramente establecida por
<span class="citation">Vries (<a href="#ref-deVries1900" role="doc-biblioref">1900</a>)</span> durante el re-descubrimiento de las leyes de Mendel<a href="genética-de-poblaciones.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Reginald Crundall Punnett, genetista británico que fue quien los
desarrolló. Además, Punnett se relaciona directamente con el
equilibrio de Hardy-Weinberg, ya que al no poder contrarrestar los
argumentos de George Udny Yule acerca del crecimiento sostenido de
los alelos dominantes, llevó el problema al matemático Godfrey
Harold Hardy, con quien jugaba al cricket; el resto es historia
conocida.<a href="genética-de-poblaciones.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="epidemio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-PopGenetics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["HWEA2022.pdf", "HWEA2022.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
